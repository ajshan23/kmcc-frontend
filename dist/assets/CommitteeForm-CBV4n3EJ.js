import{d as E,u as S,r as i,j as t,T as w,h as N,i as F}from"./index-Dgt01rRE.js";import{a as u}from"./api-CQpZrRPq.js";import{P as B}from"./PageTitle-CcVVJ2wj.js";import{l as $}from"./logo-sm-Bq_R7RX3.js";import{R as g,C}from"./Row-4Z9dirXZ.js";import{C as L,a as M}from"./Card-BG9Ed4zH.js";import{F as o}from"./Form-CB017dp8.js";import{B as y}from"./Button-B09RcjbQ.js";import"./CardHeaderContext-CackRrvh.js";import"./divWithClassName-BVSQMdwe.js";import"./FormCheck-D50FBt5F.js";import"./FormContext-Dopo7G1u.js";import"./ElementChildren-C09WryAM.js";import"./FormControl-0K0tugQX.js";import"./FormLabel-BH0-8cKa.js";import"./Button-jd7_BOcc.js";const W=()=>{const{id:n}=E(),e=!!n,p=S(),[b,r]=i.useState(!1),[T,m]=i.useState(""),[c,h]=i.useState(""),[l,x]=i.useState(""),[f,d]=i.useState(!1);i.useEffect(()=>{e&&(async()=>{try{const s=await u.get(`/constitution-committees/${n}`);if(s.status===200){const j=s.data.data;h(j.title),x(j.description||"")}}catch(s){console.error("Error fetching committee:",s),m("Failed to load committee data"),r(!0)}})()},[n,e]);const v=async a=>{if(a.preventDefault(),d(!0),!c){m("Committee title is required"),r(!0),d(!1);return}try{let s;e?s=await u.put(`/constitution-committees/${n}`,{title:c,description:l}):s=await u.post("/constitution-committees",{title:c,description:l}),s.status===(e?200:201)&&(m(`Committee ${e?"updated":"created"} successfully!`),r(!0),setTimeout(()=>{p("/constitution-committees")},1500))}catch(s){console.error(`Error ${e?"updating":"creating"} committee:`,s),m(`Failed to ${e?"update":"create"} committee. Please try again.`),r(!0)}finally{d(!1)}};return t.jsxs(t.Fragment,{children:[t.jsx(B,{title:e?"Edit Committee":"Create Committee"}),t.jsxs(w,{onClose:()=>r(!1),show:b,delay:3e3,autohide:!0,style:{position:"fixed",top:20,right:20,zIndex:9999},children:[t.jsxs(N,{children:[t.jsx("img",{src:$,alt:"brand-logo",height:"16",className:"me-1"}),t.jsx("strong",{className:"me-auto",children:"KMCC"})]}),t.jsx(F,{children:T})]}),t.jsx(g,{children:t.jsx(C,{xs:12,children:t.jsx(L,{children:t.jsx(M,{children:t.jsxs(o,{onSubmit:v,children:[t.jsx(g,{children:t.jsxs(C,{md:12,children:[t.jsxs(o.Group,{className:"mb-3",children:[t.jsx(o.Label,{children:"Title *"}),t.jsx(o.Control,{type:"text",value:c,onChange:a=>h(a.target.value),placeholder:"Enter committee title",required:!0})]}),t.jsxs(o.Group,{className:"mb-3",children:[t.jsx(o.Label,{children:"Description"}),t.jsx(o.Control,{as:"textarea",rows:3,value:l,onChange:a=>x(a.target.value),placeholder:"Enter committee description"})]})]})}),t.jsxs("div",{className:"d-flex justify-content-end mt-4",children:[t.jsx(y,{variant:"secondary",className:"me-2",onClick:()=>p("/constitution-committees"),children:"Cancel"}),t.jsx(y,{variant:"primary",type:"submit",disabled:f,children:f?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"}),e?"Updating...":"Creating..."]}):e?"Update Committee":"Create Committee"})]})]})})})})})]})};export{W as default};
