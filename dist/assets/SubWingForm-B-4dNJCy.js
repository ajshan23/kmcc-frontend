import{d as P,u as k,r as n,j as e,T as B,h as L,i as G}from"./index-C4h4LeeC.js";import"./iconify-Cb3atxOG.js";import{a as x}from"./api-CQpZrRPq.js";import{P as M}from"./PageTitle-CWWablCN.js";import{l as R}from"./logo-sm-Bq_R7RX3.js";import{R as S}from"./Row-q3Ki7zJR.js";import{C as j}from"./Col-DtQoyYva.js";import{C as $,a as D}from"./Card-C11WjSz1.js";import{F as a}from"./Form-D3LbNE2c.js";import{B as F}from"./Button-44QDA4_g.js";import"./CardHeaderContext-DEdCtnK_.js";import"./divWithClassName-D8tIs208.js";import"./FormCheck-kNP21EUQ.js";import"./FormContext-BAY9kC9G.js";import"./ElementChildren-CJn4I1Gs.js";import"./FormControl-BR82fO97.js";import"./FormLabel-CMWJChb4.js";import"./Button-BvvrbRIW.js";const re=()=>{const{id:d}=P(),o=!!d,f=k(),[N,i]=n.useState(!1),[T,l]=n.useState(""),[u,b]=n.useState(""),[m,p]=n.useState("#FFFFFF"),[c,g]=n.useState("#000000"),[C,W]=n.useState(null),[w,y]=n.useState(null),[v,h]=n.useState(!1);n.useEffect(()=>{o&&(async()=>{try{const s=await x.get(`/sub-wing/${d}`);if(s.status===200){const r=s.data.data;b(r.name),p(r.backgroundColor),g(r.mainColor),y(r.icon)}}catch(s){console.error("Error fetching sub-wing:",s),l("Failed to load sub-wing data"),i(!0)}})()},[d,o]);const E=t=>{const s=t.target.files[0];if(s){if(s.type!=="image/svg+xml"){l("Only SVG files are allowed for the icon"),i(!0);return}W(s);const r=new FileReader;r.onload=()=>{y(r.result)},r.readAsDataURL(s)}},I=async t=>{if(t.preventDefault(),h(!0),!u){l("Sub-wing name is required"),i(!0),h(!1);return}const s=new FormData;s.append("name",u),s.append("backgroundColor",m),s.append("mainColor",c),C&&s.append("icon",C);try{let r;o?r=await x.put(`/sub-wing/${d}`,s,{headers:{"Content-Type":"multipart/form-data"}}):r=await x.post("/sub-wing",s,{headers:{"Content-Type":"multipart/form-data"}}),r.status===(o?200:201)&&(l(`Sub-wing ${o?"updated":"created"} successfully!`),i(!0),setTimeout(()=>{f("/sub-wing")},1500))}catch(r){console.error(`Error ${o?"updating":"creating"} sub-wing:`,r),l(`Failed to ${o?"update":"create"} sub-wing. Please try again.`),i(!0)}finally{h(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(M,{title:o?"Edit Sub-Wing":"Create Sub-Wing"}),e.jsxs(B,{onClose:()=>i(!1),show:N,delay:3e3,autohide:!0,style:{position:"fixed",top:20,right:20,zIndex:9999},children:[e.jsxs(L,{children:[e.jsx("img",{src:R,alt:"brand-logo",height:"16",className:"me-1"}),e.jsx("strong",{className:"me-auto",children:"KMCC"})]}),e.jsx(G,{children:T})]}),e.jsx(S,{children:e.jsx(j,{xs:12,children:e.jsx($,{children:e.jsx(D,{children:e.jsxs(a,{onSubmit:I,children:[e.jsxs(S,{children:[e.jsxs(j,{md:6,children:[e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Sub-Wing Name"}),e.jsx(a.Control,{type:"text",value:u,onChange:t=>b(t.target.value),placeholder:"Enter sub-wing name",required:!0})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Background Color"}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(a.Control,{type:"color",value:m,onChange:t=>p(t.target.value),style:{width:"60px",height:"40px"}}),e.jsx(a.Control,{type:"text",value:m,onChange:t=>p(t.target.value),className:"ms-2",placeholder:"#FFFFFF"})]})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Main Color"}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(a.Control,{type:"color",value:c,onChange:t=>g(t.target.value),style:{width:"60px",height:"40px"}}),e.jsx(a.Control,{type:"text",value:c,onChange:t=>g(t.target.value),className:"ms-2",placeholder:"#000000"})]})]})]}),e.jsxs(j,{md:6,children:[e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Icon (SVG only)"}),e.jsx(a.Control,{type:"file",accept:"image/svg+xml",onChange:E}),w&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{children:"Preview:"}),e.jsx("img",{src:w,alt:"Icon preview",style:{height:"100px"}})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h5",{children:"Color Preview"}),e.jsx("div",{style:{backgroundColor:m,color:c,padding:"20px",borderRadius:"8px",border:`1px solid ${c}`},children:e.jsx("p",{className:"mb-0",children:"This is how your sub-wing colors will look together."})})]})]})]}),e.jsxs("div",{className:"d-flex justify-content-end mt-4",children:[e.jsx(F,{variant:"secondary",className:"me-2",onClick:()=>f("/sub-wing"),children:"Cancel"}),e.jsx(F,{variant:"primary",type:"submit",disabled:v,children:v?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"}),o?"Updating...":"Creating..."]}):o?"Update Sub-Wing":"Create Sub-Wing"})]})]})})})})})]})};export{re as default};
