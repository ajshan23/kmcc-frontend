import{r,u as C,j as e,T as N,h as D,i as T,L as E}from"./index-DKQPNifM.js";import{a as p}from"./api-BAouzzCb.js";import{P as L}from"./PageTitle-CRu15oFp.js";import{I as l}from"./IconifyIcon-Cz5kna7C.js";import{l as b}from"./logo-sm-DeRMNujR.js";import{R as u,C as f}from"./Row-Z0t_gNsB.js";import{B as o}from"./Button-CJm9uxN6.js";import{C as A}from"./Card-D59v7jI9.js";import{C as B}from"./CardBody-DcEFUZwh.js";import{T as I}from"./Table-CQf6JiUU.js";import{B as k}from"./Badge-C8PV2b9o.js";import"./iconify-BZ3wrvzO.js";import"./Button-dGMJGo8F.js";import"./CardHeaderContext-kdxd1e-2.js";import"./divWithClassName-CmLA-jjW.js";const se=()=>{const[d,v]=r.useState([]),[M,R]=r.useState(!1),[G,z]=r.useState(null),[y,i]=r.useState(!1),[P,n]=r.useState(""),[F,c]=r.useState(!1),[a,h]=r.useState({page:1,limit:10,total:0});console.log("ethy");const S=C(),m=async()=>{c(!0);try{const s=await p.get("/gold/all",{params:{page:a.page,limit:a.limit}});v(s.data.data),h(t=>({...t,total:s.data.data.length}))}catch(s){console.error("Error fetching programs:",s),n("Failed to load programs"),i(!0)}finally{c(!1)}};r.useEffect(()=>{m()},[a.page]);const w=async s=>{var t,x;try{await p.post("/gold/end",{programId:s}),n("Program ended successfully"),i(!0),m()}catch(j){console.error("Error ending program:",j),n(((x=(t=j.response)==null?void 0:t.data)==null?void 0:x.message)||"Failed to end program"),i(!0)}},g=s=>{h(t=>({...t,page:s}))};return e.jsxs("div",{className:"p-4",children:[e.jsx(L,{title:"Gold Investment Programs"}),e.jsxs(N,{onClose:()=>i(!1),show:y,delay:5e3,autohide:!0,style:{position:"fixed",top:20,right:20,zIndex:9999},children:[e.jsxs(D,{children:[e.jsx("img",{src:b,alt:"brand-logo",height:"16",className:"me-1"}),e.jsx("strong",{className:"me-auto",children:"GOLD PROGRAM"})]}),e.jsx(T,{children:P})]}),e.jsx(u,{className:"mb-3",children:e.jsx(f,{children:e.jsxs(o,{as:E,to:"/gold-programs/new",variant:"primary",children:[e.jsx(l,{icon:"mdi:plus"})," Start New Program"]})})}),e.jsx(u,{children:e.jsx(f,{xs:12,children:e.jsx(A,{children:e.jsxs(B,{children:[e.jsxs(I,{striped:!0,hover:!0,responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Start Date"}),e.jsx("th",{children:"End Date"}),e.jsx("th",{children:"Lots"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:d.map(s=>{var t;return e.jsxs("tr",{children:[e.jsx("td",{children:s.name}),e.jsx("td",{children:e.jsx(k,{bg:s.isActive?"success":"secondary",children:s.isActive?"Active":"Ended"})}),e.jsx("td",{children:new Date(s.startDate).toLocaleDateString()}),e.jsx("td",{children:s.endDate?new Date(s.endDate).toLocaleDateString():"-"}),e.jsx("td",{children:((t=s._count)==null?void 0:t.lots)||0}),e.jsxs("td",{children:[e.jsx(o,{size:"sm",variant:"info",className:"me-2",onClick:()=>S(`/gold-programs/${s.id}`),children:e.jsx(l,{icon:"mdi:eye"})}),s.isActive&&e.jsx(o,{size:"sm",variant:"warning",className:"me-2",onClick:()=>w(s.id),children:e.jsx(l,{icon:"mdi:stop"})})]})]},s.id)})})]}),e.jsxs("div",{className:"d-flex justify-content-center mt-3",children:[e.jsx(o,{variant:"light",disabled:a.page===1,onClick:()=>g(a.page-1),children:"Previous"}),e.jsxs("span",{className:"mx-3 align-self-center",children:["Page ",a.page]}),e.jsx(o,{variant:"light",disabled:d.length<a.limit,onClick:()=>g(a.page+1),children:"Next"})]})]})})})})]})};export{se as default};
