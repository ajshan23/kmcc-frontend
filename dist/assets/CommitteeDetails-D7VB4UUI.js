import{d as L,u as q,r as s,j as e,T as G,h as J,i as O,L as Q}from"./index-BWKLWp2a.js";import{P as U}from"./PageTitle-DL7ojCXH.js";import{a as y}from"./api-CQpZrRPq.js";import{I as f}from"./IconifyIcon-DWo7cmsQ.js";import{l as V}from"./logo-sm-Bq_R7RX3.js";import{M as W}from"./MemberForm-Clji7cTj.js";import{S as C}from"./Spinner-CdSHaVLM.js";import{R as S}from"./Row-V7i5xCpB.js";import{C as T}from"./Col-C4wMi2v-.js";import{C as g}from"./Card-CWWYwgtx.js";import{B as X}from"./Badge-D1XIvkjl.js";import{B as l}from"./Button-Dv0UYMmi.js";import{T as Y}from"./Tabs-Ch7JaI1M.js";import{T as w}from"./Tab-DiYxvgd9.js";import{T as D}from"./Table-DeKJQtPO.js";import{M as i}from"./Modal-DCjXyMUz.js";import"./iconify-n91bYVR1.js";import"./cropper-EMhSPaRr.js";import"./Form-B53MJkKZ.js";import"./FormCheck-DtPc7GjH.js";import"./FormContext-4W2HT6MH.js";import"./FormCheckInput-B8900dye.js";import"./ElementChildren-Bf8dG_zA.js";import"./FormControl-C4UrPRDY.js";import"./FormLabel-C-mxrP7_.js";import"./Alert-BeJkxiVA.js";import"./hook-C5lidwm2.js";import"./extends-CF3RwP-h.js";import"./divWithClassName-D2fuI0u2.js";import"./Anchor-Dra9T2qi.js";import"./useEventCallback-625_xS6O.js";import"./Button-C6xMcIFL.js";import"./CardHeaderContext-CGj4Ymt7.js";import"./TabPane-DH9KCgx8.js";import"./Nav-DWdzz082.js";import"./DataKey-COGXBUcQ.js";import"./NavContext-D_R0DV-I.js";import"./useMergedRefs-BNQwCw-c.js";import"./NavItem-BnQdYkaQ.js";import"./NavbarContext-BgaVPXUJ.js";import"./NavLink-5CglTHP9.js";import"./NoopTransition-BYS5XlVR.js";import"./AbstractModalHeader-Cj6HN8us.js";import"./useWindow-CgjI47pI.js";import"./usePrevious-BQjOGUf2.js";import"./hasClass-Dsb8l2C3.js";const Je=()=>{const{committeeId:a}=L(),B=q(),[d,A]=s.useState(null),[m,b]=s.useState([]),[I,M]=s.useState(!0),[h,N]=s.useState(!1),[k,c]=s.useState(!1),[E,x]=s.useState(""),[$,j]=s.useState(!1),[z,p]=s.useState(!1),[n,v]=s.useState(null),[F,H]=s.useState("details");s.useEffect(()=>{(async()=>{var r,o;try{M(!0);const[u,K]=await Promise.all([y.get(`/constitution-committees/${a}`),y.get(`/constitution-committees/${a}/members`)]);A(u.data.data),b(K.data.data)}catch(u){console.error("Error fetching committee details:",u),x(((o=(r=u.response)==null?void 0:r.data)==null?void 0:o.message)||"Failed to load committee details"),c(!0)}finally{M(!1)}})()},[a]);const P=t=>{b([...m,t]),j(!1),x("Member added successfully"),c(!0)},R=async()=>{var t,r;if(n)try{N(!0),await y.delete(`/constitution-committees/members/${n.id}`),b(m.filter(o=>o.id!==n.id)),x("Member deleted successfully"),c(!0)}catch(o){console.error("Error deleting member:",o),x(((r=(t=o.response)==null?void 0:t.data)==null?void 0:r.message)||"Failed to delete member"),c(!0)}finally{N(!1),p(!1),v(null)}};return I?e.jsx("div",{className:"d-flex justify-content-center p-5",children:e.jsx(C,{animation:"border",variant:"primary"})}):d?e.jsxs("div",{className:"d-flex p-4",children:[e.jsx(U,{title:"Committee Details"}),e.jsxs(G,{onClose:()=>c(!1),show:k,delay:5e3,autohide:!0,style:{position:"fixed",top:20,right:20,zIndex:9999},children:[e.jsxs(J,{children:[e.jsx("img",{src:V,alt:"brand-logo",height:"16",className:"me-1"}),e.jsx("strong",{className:"me-auto",children:"KMCC"})]}),e.jsx(O,{children:E})]}),e.jsx(S,{className:"w-100",children:e.jsx(T,{xs:12,children:e.jsx(g,{children:e.jsxs(g.Body,{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsxs("h4",{children:[d.title,e.jsxs(X,{bg:"primary",className:"ms-2",children:[m.length," Members"]})]}),e.jsxs("div",{children:[e.jsxs(l,{variant:"primary",className:"me-2",as:Q,to:`/constitution-committees/edit/${a}`,children:[e.jsx(f,{icon:"mdi:pencil",className:"me-1"}),"Edit"]}),e.jsxs(l,{variant:"success",onClick:()=>j(!0),children:[e.jsx(f,{icon:"mdi:plus",className:"me-1"}),"Add Member"]})]})]}),e.jsxs(Y,{activeKey:F,onSelect:t=>H(t),className:"mb-3",children:[e.jsx(w,{eventKey:"details",title:"Details",children:e.jsx(S,{className:"mt-3",children:e.jsx(T,{md:12,children:e.jsx(g,{children:e.jsxs(g.Body,{children:[e.jsx("h5",{children:"Committee Information"}),e.jsx(D,{bordered:!0,children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:"Title"}),e.jsx("td",{children:d.title})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Description"}),e.jsx("td",{children:d.description||e.jsx("span",{className:"text-muted",children:"No description"})})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Created At"}),e.jsx("td",{children:new Date(d.createdAt).toLocaleString()})]})]})})]})})})})}),e.jsx(w,{eventKey:"members",title:"Members",children:e.jsx("div",{className:"mt-3",children:e.jsxs(D,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Position"}),e.jsx("th",{children:"Image"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:m.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{children:r+1}),e.jsx("td",{children:t.name}),e.jsx("td",{children:t.position}),e.jsx("td",{children:t.image?e.jsx("img",{src:t.image,alt:t.name,style:{height:"50px"}}):e.jsx("span",{className:"text-muted",children:"No image"})}),e.jsxs("td",{children:[e.jsx(l,{variant:"primary",size:"sm",className:"me-2",onClick:()=>B(`/constitution-committees/${a}/members/edit/${t.id}`),children:e.jsx(f,{icon:"mdi:pencil",color:"white"})}),e.jsx(l,{variant:"danger",size:"sm",onClick:()=>{v(t),p(!0)},children:e.jsx(f,{icon:"mdi:delete",color:"white"})})]})]},t.id))})]})})})]})]})})})}),e.jsxs(i,{show:$,onHide:()=>j(!1),size:"lg",children:[e.jsx(i.Header,{closeButton:!0,children:e.jsx(i.Title,{children:"Add New Member"})}),e.jsx(i.Body,{children:e.jsx(W,{committeeId:a,onSuccess:P,onCancel:()=>j(!1)})})]}),e.jsxs(i,{show:z,onHide:()=>!h&&p(!1),centered:!0,children:[e.jsx(i.Header,{closeButton:!0,children:e.jsx(i.Title,{children:"Delete Member"})}),e.jsxs(i.Body,{children:['Are you sure you want to delete "',n==null?void 0:n.name,'"? This action cannot be undone.']}),e.jsxs(i.Footer,{children:[e.jsx(l,{variant:"secondary",onClick:()=>p(!1),disabled:h,children:"Cancel"}),e.jsx(l,{variant:"danger",onClick:R,disabled:h,children:h?e.jsxs(e.Fragment,{children:[e.jsx(C,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true",className:"me-1"}),"Deleting..."]}):"Delete"})]})]})]}):e.jsx("div",{className:"d-flex justify-content-center p-5",children:"Committee not found"})};export{Je as default};
