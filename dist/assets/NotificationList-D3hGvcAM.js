import{r as i,j as e,T as C,h as w,i as M}from"./index-KHl5Zwey.js";import{a as F}from"./api-CQpZrRPq.js";import{I as P}from"./IconifyIcon-DTxnPJmw.js";import{l as I}from"./logo-sm-Bq_R7RX3.js";import"./iconify-RmtcZ_gc.js";import{M as b}from"./Modal-DKpnsZb3.js";import{F as d}from"./Form-DV8yfCFc.js";import{B as v}from"./Button-Dtqr-UsE.js";import{T as k}from"./Table-Czjn_7fk.js";import{B as T}from"./Badge-CXYjLCeT.js";import{P as c}from"./Pagination-vFiIoelO.js";import"./AbstractModalHeader-Diso3CXL.js";import"./useWindow-DCg5ss3o.js";import"./usePrevious-BeyNaNs9.js";import"./useEventCallback-hcGyfkNL.js";import"./hasClass-BqjqaMwU.js";import"./useMergedRefs-D4bTKWRq.js";import"./NoopTransition-D9pjmjGL.js";import"./DataKey-COGXBUcQ.js";import"./divWithClassName-UUPJNpO1.js";import"./FormCheck-D1EV8qhw.js";import"./FormContext-DpqmDVdf.js";import"./FormCheckInput-BBmIHxcd.js";import"./ElementChildren-D9By0SA4.js";import"./FormControl-C6itCDlW.js";import"./FormLabel-BVDa38dv.js";import"./Col-DQW9fkJI.js";import"./Button-C66-hUbx.js";import"./Anchor-DdcLG5Kr.js";const E=({show:f,onClose:h})=>{const[p,m]=i.useState(""),[g,y]=i.useState(""),[S,x]=i.useState(!1),[t,j]=i.useState(!1),[o,N]=i.useState(""),u=async a=>{a.preventDefault(),x(!0);try{const n=await F.post("/notify/global",{title:p,body:g});N("Notification sent successfully!"),j(!0),h(),m(""),y("")}catch(n){console.error("Error sending notification:",n),N("Failed to send notification"),j(!0)}finally{x(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(b,{show:f,onHide:h,children:[e.jsx(b.Header,{closeButton:!0,children:e.jsx(b.Title,{children:"Send Global Notification"})}),e.jsx(b.Body,{children:e.jsxs(d,{onSubmit:u,children:[e.jsxs(d.Group,{className:"mb-3",children:[e.jsx(d.Label,{children:"Title"}),e.jsx(d.Control,{type:"text",value:p,onChange:a=>m(a.target.value),required:!0})]}),e.jsxs(d.Group,{className:"mb-3",children:[e.jsx(d.Label,{children:"Message"}),e.jsx(d.Control,{as:"textarea",rows:3,value:g,onChange:a=>y(a.target.value),required:!0})]}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx(v,{variant:"secondary",onClick:h,children:"Cancel"}),e.jsx(v,{variant:"primary",type:"submit",disabled:S,children:S?"Sending...":"Send Notification"})]})]})})]}),e.jsxs(C,{onClose:()=>j(!1),show:t,delay:3e3,autohide:!0,style:{position:"fixed",top:20,right:20,zIndex:9999},children:[e.jsxs(w,{children:[e.jsx("img",{src:I,alt:"brand-logo",height:"16",className:"me-1"}),e.jsx("strong",{className:"me-auto",children:"Notification"})]}),e.jsx(M,{children:o})]})]})},de=()=>{const[f,h]=i.useState([]),[p,m]=i.useState(!1),[g,y]=i.useState(""),[S,x]=i.useState(!1),[t,j]=i.useState(1),[o,N]=i.useState(1),u=10,a=async(s=1)=>{try{const l=(s-1)*u,r=await F.get(`/notify/admin/all?limit=${u}&offset=${l}`);h(r.data.data.notifications),N(Math.ceil(r.data.data.totalCount/u))}catch(l){console.error("Error fetching notifications:",l),y("Failed to load notifications"),m(!0)}};i.useEffect(()=>{a(t)},[t]);const n=s=>{j(s)},B=()=>{a(t)};return e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsx("h4",{children:"All Notifications"}),e.jsxs(v,{variant:"primary",onClick:()=>x(!0),children:[e.jsx(P,{icon:"mdi:bell-plus",className:"me-1"}),"Send Notification"]})]}),e.jsxs(C,{onClose:()=>m(!1),show:p,delay:3e3,autohide:!0,style:{position:"fixed",top:20,right:20,zIndex:9999},children:[e.jsxs(w,{children:[e.jsx("img",{src:I,alt:"brand-logo",height:"16",className:"me-1"}),e.jsx("strong",{className:"me-auto",children:"Notification"})]}),e.jsx(M,{children:g})]}),e.jsxs(k,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Message"}),e.jsx("th",{children:"User"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:f.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center text-muted",children:"No notifications found"})}):f.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.id}),e.jsx("td",{children:s.title}),e.jsx("td",{children:s.body}),e.jsx("td",{children:s.user?e.jsxs("div",{children:[e.jsx("div",{children:s.user.name}),e.jsx("small",{className:"text-muted",children:s.user.email})]}):e.jsx(T,{bg:"secondary",children:"Global"})}),e.jsx("td",{children:new Date(s.createdAt).toLocaleString()}),e.jsx("td",{children:e.jsx(T,{bg:s.isRead?"success":"warning",children:s.isRead?"Read":"Unread"})})]},s.id))})]}),o>1&&e.jsx("div",{className:"d-flex justify-content-center mt-3",children:e.jsxs(c,{children:[e.jsx(c.First,{onClick:()=>n(1),disabled:t===1}),e.jsx(c.Prev,{onClick:()=>n(t-1),disabled:t===1}),Array.from({length:Math.min(5,o)},(s,l)=>{let r;return o<=5||t<=3?r=l+1:t>=o-2?r=o-4+l:r=t-2+l,e.jsx(c.Item,{active:r===t,onClick:()=>n(r),children:r},r)}),e.jsx(c.Next,{onClick:()=>n(t+1),disabled:t===o}),e.jsx(c.Last,{onClick:()=>n(o),disabled:t===o})]})}),e.jsx(E,{show:S,onClose:()=>{x(!1),B()}})]})};export{de as default};
