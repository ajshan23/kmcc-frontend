import{r as i,j as e,T,h as P,i as k,L as j}from"./index-VzOysTvz.js";import{P as I}from"./PageTitle-Amhy0bFR.js";import{a as y}from"./api-CQpZrRPq.js";import{I as b}from"./IconifyIcon-LG_YGEyj.js";import{l as E}from"./logo-sm-Bq_R7RX3.js";import{R as f}from"./Row-CIJAanl2.js";import{C as h}from"./Col-acre0jtq.js";import{B as r}from"./Button-BylzbV0n.js";import{M as l}from"./Modal-uTnZp0H6.js";import"./iconify-SC4jjo5u.js";import"./Button-BedQCe8q.js";import"./AbstractModalHeader-CYOOHbh1.js";import"./useWindow-DwJfH7qm.js";import"./usePrevious-Bp3ZFrZt.js";import"./useEventCallback-BXPt9DmV.js";import"./hasClass-y6dCwSy4.js";import"./useMergedRefs-DEAAT-Ds.js";import"./NoopTransition-Dkb_vz_R.js";import"./DataKey-COGXBUcQ.js";import"./divWithClassName-C0MZErg6.js";const _=()=>{const[v,m]=i.useState([]),[N,n]=i.useState(!1),[o,x]=i.useState(null),[w,d]=i.useState(!1),[A,p]=i.useState(""),[c,M]=i.useState(""),[a,g]=i.useState({page:1,limit:10,totalCount:0,totalPages:1});i.useEffect(()=>{(async()=>{try{const s=await y.get("/admin/see",{params:{search:c,page:a.page,limit:a.limit}});s.status===200&&(m(s.data.data.memberships),g({page:s.data.data.pagination.page,limit:s.data.data.pagination.limit,totalCount:s.data.data.pagination.totalCount,totalPages:s.data.data.pagination.totalPages}))}catch(s){console.error("Error fetching memberships:",s)}})()},[c,a.page,a.limit]);const C=t=>{x(t),n(!0)},S=async()=>{if(o)try{await y.delete(`/admin/memberships/${o.id}`),m(t=>t.filter(s=>s.id!==o.id)),p("Membership deleted successfully!"),d(!0)}catch(t){console.error("Error deleting membership:",t),p("Failed to delete membership."),d(!0)}finally{n(!1),x(null)}},u=t=>{g(s=>({...s,page:t}))};return e.jsxs("div",{className:"d-flex p-4",children:[e.jsx(I,{title:"Memberships"}),e.jsxs(T,{onClose:()=>d(!1),show:w,delay:5e3,autohide:!0,style:{position:"fixed",top:20,right:20,zIndex:9999},children:[e.jsxs(P,{children:[e.jsx("img",{src:E,alt:"brand-logo",height:"16",className:"me-1"}),e.jsx("strong",{className:"me-auto",children:"TECHMIN"})]}),e.jsx(k,{children:A})]}),e.jsx(f,{children:e.jsx(h,{xs:12,children:e.jsxs("div",{style:{width:"70vw",background:"white",border:"1px solid gray",padding:10,borderRadius:10},children:[e.jsxs(f,{className:"d-flex justify-content-between align-items-center p-2",children:[e.jsx(h,{xs:"auto",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Search",style:{width:"250px",borderRadius:10},value:c,onChange:t=>M(t.target.value)})}),e.jsx(h,{xs:"auto",children:e.jsx(r,{type:"button",variant:"dark",style:{padding:"10px 20px",borderRadius:10},as:j,to:"/memberships/new",children:"New Membership"})})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-striped",style:{width:"100%",textAlign:"center"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{textAlign:"center"},children:"Member ID"}),e.jsx("th",{style:{textAlign:"center"},children:"Iqama Number"}),e.jsx("th",{style:{textAlign:"center"},children:"Name"}),e.jsx("th",{style:{textAlign:"center"},children:"Phone Number"}),e.jsx("th",{style:{textAlign:"center"},children:"Status"}),e.jsx("th",{style:{textAlign:"center"},children:"Constituency"}),e.jsx("th",{style:{textAlign:"center"},children:"Actions"})]})}),e.jsx("tbody",{children:v.map((t,s)=>e.jsxs("tr",{children:[e.jsx("td",{style:{verticalAlign:"middle"},children:t.memberId}),e.jsx("td",{style:{verticalAlign:"middle"},children:t.iqamaNumber}),e.jsx("td",{style:{verticalAlign:"middle"},children:t.name}),e.jsx("td",{style:{verticalAlign:"middle"},children:t.phoneNumber||"N/A"}),e.jsx("td",{style:{verticalAlign:"middle"},children:e.jsx("span",{className:`badge bg-${t.status==="active"?"success":"danger"}`,children:t.status})}),e.jsx("td",{style:{verticalAlign:"middle"},children:t.areaName||"N/A"}),e.jsxs("td",{style:{verticalAlign:"middle"},children:[e.jsx(r,{type:"button",variant:"primary",className:"me-2",as:j,to:`/memberships/edit/${t.id}`,children:e.jsx(b,{icon:"mdi:account-edit",color:"white"})}),e.jsx(r,{type:"button",variant:"danger",onClick:()=>C(t),children:e.jsx(b,{icon:"ri:delete-bin-4-fill",color:"white"})})]})]},s))})]})}),e.jsxs("div",{className:"d-flex justify-content-center mt-3",children:[e.jsx(r,{variant:"secondary",onClick:()=>u(a.page-1),disabled:a.page===1,children:"Previous"}),e.jsxs("span",{className:"mx-3",children:["Page ",a.page," of ",a.totalPages]}),e.jsx(r,{variant:"secondary",onClick:()=>u(a.page+1),disabled:a.page===a.totalPages,children:"Next"})]})]})})}),e.jsxs(l,{show:N,onHide:()=>n(!1),centered:!0,children:[e.jsx(l.Header,{closeButton:!0,children:e.jsx(l.Title,{children:"Delete Membership"})}),e.jsx(l.Body,{children:"Are you sure you want to delete this membership? This action cannot be undone."}),e.jsxs(l.Footer,{children:[e.jsx(r,{variant:"secondary",onClick:()=>n(!1),children:"Cancel"}),e.jsx(r,{variant:"danger",onClick:S,children:"Delete"})]})]})]})};export{_ as default};
