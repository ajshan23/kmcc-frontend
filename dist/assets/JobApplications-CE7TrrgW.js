import{r as a,l as A,j as e,m as P,P as n,d as B,T as M,h as E,i as $,L as z}from"./index-BWKLWp2a.js";import{P as H}from"./PageTitle-DL7ojCXH.js";import{a as C}from"./api-CQpZrRPq.js";import{I as L}from"./IconifyIcon-DWo7cmsQ.js";import{l as J}from"./logo-sm-Bq_R7RX3.js";import{R as D}from"./Row-V7i5xCpB.js";import{C as F}from"./Col-C4wMi2v-.js";import{B as O}from"./Badge-D1XIvkjl.js";import{T as V}from"./Table-DeKJQtPO.js";import{B as l}from"./Button-Dv0UYMmi.js";import{M as d}from"./Modal-DCjXyMUz.js";import"./iconify-n91bYVR1.js";import"./Button-C6xMcIFL.js";import"./AbstractModalHeader-Cj6HN8us.js";import"./useWindow-CgjI47pI.js";import"./usePrevious-BQjOGUf2.js";import"./useEventCallback-625_xS6O.js";import"./hasClass-Dsb8l2C3.js";import"./useMergedRefs-BNQwCw-c.js";import"./NoopTransition-BYS5XlVR.js";import"./DataKey-COGXBUcQ.js";import"./divWithClassName-D2fuI0u2.js";n.string,n.bool,n.bool,n.bool,n.bool;const T=a.forwardRef(({bsPrefix:i,className:h,fluid:p=!1,rounded:o=!1,roundedCircle:x=!1,thumbnail:u=!1,...c},j)=>(i=A(i,"img"),e.jsx("img",{ref:j,...c,className:P(h,p&&`${i}-fluid`,o&&"rounded",x&&"rounded-circle",u&&`${i}-thumbnail`)})));T.displayName="Image";const he=()=>{const{jobId:i}=B(),[h,p]=a.useState([]),[o,x]=a.useState(null),[u,c]=a.useState(!0),[j,g]=a.useState(!1),[I,y]=a.useState(""),[s,v]=a.useState({page:1,limit:10,total:0}),[S,f]=a.useState(!1),[m,R]=a.useState(null);a.useEffect(()=>{(async()=>{try{c(!0);const r=await C.get(`/jobs/${i}`);x(r.data.data);const b=await C.get(`/jobs/get-applications/${i}?page=${s.page}&limit=${s.limit}`);p(b.data.data.applications),v(k=>({...k,total:b.data.data.pagination.totalApplications,totalPages:b.data.data.pagination.totalPages}))}catch(r){console.error("Error fetching data:",r),y("Failed to fetch job applications."),g(!0)}finally{c(!1)}})()},[i,s.page,s.limit]);const N=t=>{t>0&&t<=s.totalPages&&v(r=>({...r,page:t}))},w=t=>{if(!t){y("No resume available for this application."),g(!0);return}R(t),f(!0)};return u?e.jsx("div",{className:"d-flex justify-content-center p-5",children:"Loading..."}):e.jsxs("div",{className:"d-flex p-4",children:[e.jsx(H,{title:"Job Applications"}),e.jsxs(M,{onClose:()=>g(!1),show:j,delay:5e3,autohide:!0,style:{position:"fixed",top:20,right:20,zIndex:9999},children:[e.jsxs(E,{children:[e.jsx("img",{src:J,alt:"brand-logo",height:"16",className:"me-1"}),e.jsx("strong",{className:"me-auto",children:"TECHMIN"})]}),e.jsx($,{children:I})]}),e.jsx(D,{className:"w-100",children:e.jsx(F,{xs:12,children:e.jsxs("div",{style:{background:"white",border:"1px solid gray",padding:20,borderRadius:10},children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsxs("h4",{children:["Applications for: ",o==null?void 0:o.position," at"," ",o==null?void 0:o.companyName]}),e.jsxs(O,{bg:"info",className:"fs-6",children:["Total Applications: ",s.total]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs(V,{striped:!0,bordered:!0,hover:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Full Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Phone"}),e.jsx("th",{children:"Applied On"}),e.jsx("th",{children:"Resume"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:h.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{children:(s.page-1)*s.limit+r+1}),e.jsx("td",{children:t.fullName}),e.jsx("td",{children:t.email}),e.jsx("td",{children:t.phone}),e.jsx("td",{children:new Date(t.createdAt).toLocaleDateString()}),e.jsx("td",{children:t.resume?e.jsx(l,{variant:"link",onClick:()=>w(t.resume),children:"View Resume"}):"No Resume"}),e.jsx("td",{children:e.jsx(l,{variant:"primary",size:"sm",onClick:()=>w(t.resume),disabled:!t.resume,children:e.jsx(L,{icon:"mdi:eye",color:"white"})})})]},t.id))})]})}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsxs("div",{children:["Showing ",(s.page-1)*s.limit+1," to"," ",Math.min(s.page*s.limit,s.total)," ","of ",s.total," entries"]}),e.jsxs("div",{children:[e.jsx(l,{variant:"outline-primary",size:"sm",disabled:s.page===1,onClick:()=>N(s.page-1),className:"me-2",children:"Previous"}),e.jsx(l,{variant:"outline-primary",size:"sm",disabled:s.page>=s.totalPages,onClick:()=>N(s.page+1),children:"Next"})]})]}),e.jsx("div",{className:"mt-3",children:e.jsx(l,{as:z,to:"/job",variant:"secondary",children:"Back to Jobs"})})]})})}),e.jsxs(d,{show:S,onHide:()=>f(!1),size:"lg",centered:!0,children:[e.jsx(d.Header,{closeButton:!0,children:e.jsx(d.Title,{children:"Applicant Resume"})}),e.jsx(d.Body,{className:"text-center",children:m&&e.jsx(T,{src:m,alt:"Applicant Resume",fluid:!0,style:{maxHeight:"70vh"}})}),e.jsxs(d.Footer,{children:[e.jsx(l,{variant:"secondary",onClick:()=>f(!1),children:"Close"}),m&&e.jsx(l,{variant:"primary",onClick:()=>{const t=document.createElement("a");t.href=m,t.download=`resume_${new Date().getTime()}.jpg`,document.body.appendChild(t),t.click(),document.body.removeChild(t)},children:"Download Image"})]})]})]})};export{he as default};
