import{d as B,r,j as s,T as C,h as R,i as E,L as I}from"./index-CfNT85tM.js";import{P}from"./PageTitle-D_HZ265t.js";import{a as Q}from"./api-BAouzzCb.js";import"./iconify-Dnpwx_79.js";import{l as q}from"./logo-sm-DeRMNujR.js";import{C as H}from"./Container-VWyJRJ43.js";import{C as n}from"./Card-BxC9ygCX.js";import{B as h}from"./Badge-Dxw4lbGc.js";import{B as M}from"./Button-DmtmunvM.js";import{R as k,C as m}from"./Row-pUvplkm2.js";import{A as c}from"./Accordion-DhH0OqEG.js";import{T as x}from"./Table-DAjJSobz.js";import"./CardBody-TiP-bp9B.js";import"./CardHeaderContext-DMh6jMut.js";import"./divWithClassName-MTQsKDs0.js";import"./Button-AVmPP0NH.js";import"./hook-9Fc7o0VZ.js";import"./extends-CF3RwP-h.js";import"./Collapse-C6JuMik2.js";import"./createChainedFunction-Vh3cVaa6.js";const ns=()=>{const{surveyId:a}=B(),[j,u]=r.useState({}),[p,y]=r.useState([]),[o,f]=r.useState(null),[w,b]=r.useState(0),[g,v]=r.useState(""),[S,d]=r.useState(!1),[l,T]=r.useState(null);r.useEffect(()=>{a&&A()},[a]);const A=async()=>{try{const e=await Q.get(`/survey/answers/${a}`);if(e.status===200){const t=e.data.data;f(t.survey),u(t.answers),y(t.statistics),b(t.totalRespondents)}}catch(e){console.error("Error fetching survey answers:",e),v("Failed to fetch survey answers"),d(!0)}},N=e=>{T(l===e?null:e)};return s.jsxs(H,{className:"p-4",children:[s.jsx(P,{title:"Survey Answers"}),s.jsxs(C,{onClose:()=>d(!1),show:S,delay:5e3,autohide:!0,style:{position:"fixed",top:20,right:20,zIndex:9999},children:[s.jsxs(R,{children:[s.jsx("img",{src:q,alt:"brand-logo",height:"16",className:"me-1"}),s.jsx("strong",{className:"me-auto",children:"TECHMIN"})]}),s.jsx(E,{children:g})]}),o&&s.jsx(n,{className:"mb-4",children:s.jsxs(n.Body,{children:[s.jsx(n.Title,{children:o.title}),s.jsx(n.Subtitle,{className:"mb-2 text-muted",children:o.description}),s.jsxs("div",{className:"d-flex justify-content-between mt-3",children:[s.jsxs("div",{children:[s.jsxs(h,{bg:"primary",className:"me-2",children:["Questions: ",o.questions.length]}),s.jsxs(h,{bg:"success",children:["Respondents: ",w]})]}),s.jsx(M,{variant:"outline-primary",as:I,to:`/survey/answers/${a}/export`,children:"Export Answers"})]})]})}),s.jsxs(k,{children:[s.jsxs(m,{xs:12,md:6,children:[s.jsx("h4",{className:"mb-3",children:"Individual Responses"}),s.jsx(c,{activeKey:l,children:Object.entries(j).map(([e,t])=>s.jsxs(c.Item,{eventKey:e,children:[s.jsxs(c.Header,{onClick:()=>N(e),children:[t.user.name," (",t.user.memberId,")"]}),s.jsx(c.Body,{children:s.jsxs(x,{striped:!0,bordered:!0,hover:!0,children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Question"}),s.jsx("th",{children:"Answer"})]})}),s.jsx("tbody",{children:o==null?void 0:o.questions.map(i=>s.jsxs("tr",{children:[s.jsx("td",{children:i.text}),s.jsx("td",{children:t.answers[i.id]||"Not answered"})]},i.id))})]})})]},e))})]}),s.jsxs(m,{xs:12,md:6,children:[s.jsx("h4",{className:"mb-3",children:"Question Statistics"}),p.map(e=>s.jsx(n,{className:"mb-3",children:s.jsxs(n.Body,{children:[s.jsx(n.Title,{children:e.questionText}),s.jsxs(n.Subtitle,{className:"mb-2 text-muted",children:["Total answers: ",e.totalAnswers]}),s.jsxs(x,{striped:!0,bordered:!0,hover:!0,children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Option"}),s.jsx("th",{children:"Count"}),s.jsx("th",{children:"Percentage"})]})}),s.jsx("tbody",{children:e.options.map((t,i)=>s.jsxs("tr",{children:[s.jsx("td",{children:t.option}),s.jsx("td",{children:t.count}),s.jsxs("td",{children:[t.percentage,"%"]})]},i))})]})]})},e.questionId))]})]})]})};export{ns as default};
