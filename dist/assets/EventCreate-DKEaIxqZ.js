import{a as J,r as n,j as e,T as _,g as q,h as K}from"./index-DPuNUjLg.js";import{l as Q}from"./cropper-MwML4X9w.js";import{I as l}from"./IconifyIcon-CRmgpD-A.js";import{a as V}from"./api-alN533tX.js";import{P as ee}from"./PageTitle-CqWn3q0T.js";import{l as te}from"./logo-sm-DeRMNujR.js";import{R as S,C as g}from"./Row-CcHO1i0D.js";import{C as H}from"./Card-BZ6UHl2I.js";import{C as R}from"./CardBody-CGT1fL4u.js";import{F as a}from"./Form-LPEeaXcj.js";import{B as c}from"./Button-BnjsKorX.js";import"./iconify-CwHMartp.js";import"./CardHeaderContext-DMcAJQTf.js";import"./divWithClassName-CR8nEuA8.js";import"./FormCheck-KaS-eO03.js";import"./FormContext-BlvwWdud.js";import"./ElementChildren-ChJp8XjW.js";import"./FormControl-bLwLOBBO.js";import"./FormLabel-B_CILb4g.js";import"./Button-CXwj5S0n.js";const Ne=()=>{const w=J(),[E,u]=n.useState(!1),[x,I]=n.useState(null),[ae,F]=n.useState({cropX:0,cropY:0,imageWidth:0,imageHeight:0,imageRotate:0,scaleX:0,scaleY:0}),[m,k]=n.useState(null),[j,D]=n.useState(""),[f,L]=n.useState(""),[v,M]=n.useState(""),[C,G]=n.useState(""),[y,P]=n.useState(""),[b,$]=n.useState(""),[p,h]=n.useState([""]),d=n.useRef(null),T=362/472,A=t=>{const s=t.target.files[0];if(s){const o=new FileReader;o.onload=()=>{I(o.result)},o.readAsDataURL(s)}},B=()=>{var s;const t=(s=d.current)==null?void 0:s.cropper;if(t){const o=t.getData(),r=t.getImageData();F({cropX:Math.ceil(o.x),cropY:Math.ceil(o.y),imageWidth:Math.ceil(r.width),imageHeight:Math.ceil(r.height),imageRotate:Math.ceil(r.rotate),scaleX:Math.ceil(r.scaleX),scaleY:Math.ceil(r.scaleY)}),t.getCroppedCanvas().toBlob(i=>{k(i)})}},U=()=>{h([...p,""])},X=t=>{const s=p.filter((o,r)=>r!==t);h(s)},Y=(t,s)=>{const o=[...p];o[t]=s,h(o)},z=async()=>{if(!m){alert("Please crop the image first.");return}const t=new File([m],"banner-image.png",{type:"image/png"}),s=i=>{const[O,W]=i.split(":"),N=parseInt(O,10),Z=N>=12?"PM":"AM";return`${N%12||12}:${W} ${Z}`},o=`${s(y)} - ${s(b)}`,r=new FormData;r.append("image",t),r.append("title",j),r.append("place",f),r.append("eventType",v),r.append("eventDate",C),r.append("timing",o),r.append("highlights",JSON.stringify(p.filter(i=>i.trim()!=="")));try{const i=await V.post("/admin/create-event",r,{headers:{"Content-Type":"multipart/form-data"}});console.log(i),i.status===200?(u(!0),setTimeout(()=>{w("/event")},2e3)):(alert("Failed to upload banner."),console.error("Upload failed:",i.data))}catch(i){console.error("Error uploading banner:",i),alert("Failed to upload banner.")}};return e.jsxs(e.Fragment,{children:[e.jsx(ee,{title:"New event"}),e.jsxs(_,{onClose:()=>u(!1),show:E,delay:2e3,autohide:!0,style:{position:"fixed",top:20,right:20,zIndex:9999},children:[e.jsxs(q,{children:[e.jsx("img",{src:te,alt:"brand-logo",height:"16",className:"me-1"}),e.jsx("strong",{className:"me-auto",children:"TECHMIN"})]}),e.jsx(K,{children:"Event created successfully."})]}),e.jsx(S,{children:e.jsx(g,{xs:12,children:e.jsx(H,{children:e.jsx(R,{children:e.jsxs(S,{children:[e.jsxs(g,{lg:9,children:[e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Upload Event Image (362x472)"}),e.jsx(a.Control,{type:"file",accept:"image/*",onChange:A})]}),x&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"img-container",children:e.jsx(Q,{src:x,style:{height:400,width:"100%"},initialAspectRatio:T,aspectRatio:T,guides:!1,crop:B,ref:d,rotatable:!0,scalable:!0,zoomable:!0})}),e.jsx(H,{children:e.jsx(R,{children:e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[e.jsxs(c,{onClick:()=>{var t;return(t=d.current)==null?void 0:t.cropper.zoom(.1)},children:[e.jsx(l,{icon:"mdi:magnify-plus-outline"})," Zoom In"]}),e.jsxs(c,{onClick:()=>{var t;return(t=d.current)==null?void 0:t.cropper.zoom(-.1)},children:[e.jsx(l,{icon:"mdi:magnify-minus-outline"})," Zoom Out"]}),e.jsxs(c,{onClick:()=>{var t;return(t=d.current)==null?void 0:t.cropper.rotate(-45)},children:[e.jsx(l,{icon:"mdi:rotate-left"})," Rotate Left"]}),e.jsxs(c,{onClick:()=>{var t;return(t=d.current)==null?void 0:t.cropper.rotate(45)},children:[e.jsx(l,{icon:"mdi:rotate-right"})," Rotate Right"]}),e.jsxs(c,{onClick:()=>{var t;return(t=d.current)==null?void 0:t.cropper.reset()},children:[e.jsx(l,{icon:"mdi:sync"})," Reset"]}),e.jsxs(c,{onClick:()=>{var t;return(t=d.current)==null?void 0:t.cropper.clear()},children:[e.jsx(l,{icon:"mdi:close"})," Clear"]})]})})})]})]}),e.jsxs(g,{lg:3,children:[e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Event Title"}),e.jsx(a.Control,{type:"text",value:j,onChange:t=>D(t.target.value),placeholder:"Enter event title"})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Place"}),e.jsx(a.Control,{type:"text",value:f,onChange:t=>L(t.target.value),placeholder:"Enter event place"})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Event Type"}),e.jsxs(a.Control,{as:"select",value:v,onChange:t=>M(t.target.value),children:[e.jsx("option",{value:"",children:"Select event type"}),e.jsx("option",{value:"concert",children:"Concert"}),e.jsx("option",{value:"conference",children:"Conference"}),e.jsx("option",{value:"workshop",children:"Workshop"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Date"}),e.jsx(a.Control,{type:"date",value:C,onChange:t=>G(t.target.value)})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Start Time"}),e.jsx(a.Control,{type:"time",value:y,onChange:t=>P(t.target.value)})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"End Time"}),e.jsx(a.Control,{type:"time",value:b,onChange:t=>$(t.target.value)})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Highlights"}),p.map((t,s)=>e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx(a.Control,{type:"text",value:t,onChange:o=>Y(s,o.target.value),placeholder:`Highlight ${s+1}`}),e.jsx(c,{variant:"danger",className:"ms-2",onClick:()=>X(s),children:e.jsx(l,{icon:"mdi:delete"})})]},s)),e.jsxs(c,{variant:"secondary",className:"w-100",onClick:U,children:[e.jsx(l,{icon:"mdi:plus"})," Add Highlight"]})]}),e.jsxs(c,{variant:"primary",className:"w-100 mt-3",onClick:z,disabled:!m,children:[e.jsx(l,{icon:"mdi:upload"})," Create Event"]})]})]})})})})})]})};export{Ne as default};
