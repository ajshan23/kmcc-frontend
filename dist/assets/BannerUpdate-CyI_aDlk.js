import{u as B,r as d,j as e,T as D,h as F,i as L}from"./index-DKQPNifM.js";import{l as M}from"./cropper-B1mUTWjM.js";import{I as i}from"./IconifyIcon-Cz5kna7C.js";import{a as S}from"./api-BAouzzCb.js";import{l as k}from"./logo-sm-DeRMNujR.js";import{R as h,C as m}from"./Row-Z0t_gNsB.js";import{C as j}from"./Card-D59v7jI9.js";import{C as f}from"./CardBody-DcEFUZwh.js";import{F as t}from"./Form-msQAt-qp.js";import{B as l}from"./Button-CJm9uxN6.js";import"./iconify-BZ3wrvzO.js";import"./CardHeaderContext-kdxd1e-2.js";import"./divWithClassName-CmLA-jjW.js";import"./FormCheck-BrYDrZ1e.js";import"./FormContext-wZ54zJwb.js";import"./FormCheckInput-B_azkgLI.js";import"./ElementChildren-CJ8krY86.js";import"./FormControl-BA3XJbTj.js";import"./FormLabel-BnU1TUmx.js";import"./Button-dGMJGo8F.js";const ae=()=>{const C=B(),[y,x]=d.useState(!1),[u,b]=d.useState(null),[n,R]=d.useState({cropX:0,cropY:0,imageWidth:0,imageHeight:0,imageRotate:0,scaleX:0,scaleY:0}),[p,N]=d.useState(null),s=d.useRef(null),g=376/388,I=a=>{const o=a.target.files[0];if(o){const r=new FileReader;r.onload=()=>{b(r.result)},r.readAsDataURL(o)}},v=()=>{var o;const a=(o=s.current)==null?void 0:o.cropper;if(a){const r=a.getData(),c=a.getImageData();R({cropX:Math.ceil(r.x),cropY:Math.ceil(r.y),imageWidth:Math.ceil(c.width),imageHeight:Math.ceil(c.height),imageRotate:Math.ceil(c.rotate),scaleX:Math.ceil(c.scaleX),scaleY:Math.ceil(c.scaleY)}),a.getCroppedCanvas().toBlob(T=>{N(T)})}},w=async()=>{if(!p){alert("Please crop the image first.");return}const a=new File([p],"banner-image.png",{type:"image/png"}),o=new FormData;o.append("image",a);try{const r=await S.post("/admin/upload-banner",o,{headers:{"Content-Type":"multipart/form-data"}});console.log(r),r.status===200?(x(!0),setTimeout(()=>{C("/banner")},2e3)):(alert("Failed to upload banner."),console.error("Upload failed:",r.data))}catch(r){console.error("Error uploading banner:",r),alert("Failed to upload banner.")}};return e.jsxs(e.Fragment,{children:[e.jsxs(D,{onClose:()=>x(!1),show:y,delay:2e3,autohide:!0,style:{position:"fixed",top:20,right:20,zIndex:9999},children:[e.jsxs(F,{children:[e.jsx("img",{src:k,alt:"brand-logo",height:"16",className:"me-1"}),e.jsx("strong",{className:"me-auto",children:"TECHMIN"})]}),e.jsx(L,{children:"Banner uploaded successfully."})]}),e.jsx(h,{children:e.jsx(m,{xs:12,children:e.jsx(j,{children:e.jsx(f,{children:e.jsxs(h,{children:[e.jsxs(m,{lg:9,children:[e.jsxs(t.Group,{className:"mb-3",children:[e.jsx(t.Label,{children:"Upload Banner Image (376x388)"}),e.jsx(t.Control,{type:"file",accept:"image/*",onChange:I})]}),u&&e.jsx("div",{className:"img-container",children:e.jsx(M,{src:u,style:{height:400,width:"100%"},initialAspectRatio:g,aspectRatio:g,guides:!1,crop:v,ref:s,rotatable:!0,scalable:!0,zoomable:!0})})]}),e.jsxs(m,{lg:3,children:[e.jsxs("div",{className:"docs-data",children:[e.jsxs(t.Group,{className:"mb-2",children:[e.jsx(t.Label,{children:"X"}),e.jsx(t.Control,{type:"text",value:n.cropX,readOnly:!0})]}),e.jsxs(t.Group,{className:"mb-2",children:[e.jsx(t.Label,{children:"Y"}),e.jsx(t.Control,{type:"text",value:n.cropY,readOnly:!0})]}),e.jsxs(t.Group,{className:"mb-2",children:[e.jsx(t.Label,{children:"Width"}),e.jsx(t.Control,{type:"text",value:n.imageWidth,readOnly:!0})]}),e.jsxs(t.Group,{className:"mb-2",children:[e.jsx(t.Label,{children:"Height"}),e.jsx(t.Control,{type:"text",value:n.imageHeight,readOnly:!0})]}),e.jsxs(t.Group,{className:"mb-2",children:[e.jsx(t.Label,{children:"Rotate"}),e.jsx(t.Control,{type:"text",value:n.imageRotate,readOnly:!0})]})]}),e.jsxs(l,{variant:"primary",className:"w-100 mt-3",onClick:w,disabled:!p,children:[e.jsx(i,{icon:"mdi:upload"})," Upload Banner"]})]})]})})})})}),e.jsx(h,{className:"mt-3",children:e.jsx(m,{xs:12,children:e.jsx(j,{children:e.jsx(f,{children:e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[e.jsxs(l,{onClick:()=>{var a;return(a=s.current)==null?void 0:a.cropper.zoom(.1)},children:[e.jsx(i,{icon:"mdi:magnify-plus-outline"})," Zoom In"]}),e.jsxs(l,{onClick:()=>{var a;return(a=s.current)==null?void 0:a.cropper.zoom(-.1)},children:[e.jsx(i,{icon:"mdi:magnify-minus-outline"})," Zoom Out"]}),e.jsxs(l,{onClick:()=>{var a;return(a=s.current)==null?void 0:a.cropper.rotate(-45)},children:[e.jsx(i,{icon:"mdi:rotate-left"})," Rotate Left"]}),e.jsxs(l,{onClick:()=>{var a;return(a=s.current)==null?void 0:a.cropper.rotate(45)},children:[e.jsx(i,{icon:"mdi:rotate-right"})," Rotate Right"]}),e.jsxs(l,{onClick:()=>{var a;return(a=s.current)==null?void 0:a.cropper.reset()},children:[e.jsx(i,{icon:"mdi:sync"})," Reset"]}),e.jsxs(l,{onClick:()=>{var a;return(a=s.current)==null?void 0:a.cropper.clear()},children:[e.jsx(i,{icon:"mdi:close"})," Clear"]})]})})})})})]})};export{ae as default};
