import{d as A,u as L,r as l,j as r}from"./index-CfNT85tM.js";import{a as f}from"./api-BAouzzCb.js";import{P as C}from"./PageTitle-D_HZ265t.js";import{S as E}from"./Spinner-DY2VvB9K.js";import{A as m}from"./Alert-pUsetTBW.js";import{B as h}from"./Button-DmtmunvM.js";import{R as v,C as y}from"./Row-pUvplkm2.js";import{C as b}from"./Card-BxC9ygCX.js";import{T as I}from"./Table-DAjJSobz.js";import{B as S}from"./Badge-Dxw4lbGc.js";import"./hook-9Fc7o0VZ.js";import"./extends-CF3RwP-h.js";import"./divWithClassName-MTQsKDs0.js";import"./Anchor-Kzj3Lb_I.js";import"./useEventCallback-B2meNR0i.js";import"./Button-AVmPP0NH.js";import"./CardBody-TiP-bp9B.js";import"./CardHeaderContext-DMh6jMut.js";const Q=()=>{const{programId:a}=A(),x=L(),[j,P]=l.useState([]),[e,w]=l.useState(null),[N,p]=l.useState(!0),[g,u]=l.useState(null);return l.useEffect(()=>{(async()=>{var i,n,o,d;p(!0),u(null);try{const[s,c]=await Promise.all([f.get(`/gold/${a}`),f.get(`/gold/${a}/lots/`)]);if(!((i=s.data)!=null&&i.data)||!((n=c.data)!=null&&n.data))throw new Error("Invalid data structure from API");w(s.data.data),P(c.data.data)}catch(s){console.error("Error fetching data:",s),u(((d=(o=s.response)==null?void 0:o.data)==null?void 0:d.message)||s.message||"Failed to load data")}finally{p(!1)}})()},[a]),N?r.jsx("div",{className:"text-center py-4",children:r.jsx(E,{animation:"border",role:"status",children:r.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):g?r.jsxs(m,{variant:"danger",className:"my-4",children:[r.jsx(m.Heading,{children:"Error loading data"}),r.jsx("p",{children:g}),r.jsx(h,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]}):r.jsxs(r.Fragment,{children:[r.jsx(C,{title:`Lots - ${(e==null?void 0:e.name)||"Program"}`,breadcrumbItems:[{label:"Gold Programs",path:"/gold-programs"},{label:(e==null?void 0:e.name)||"Program",path:`/gold-programs/${a}`},{label:"Lots",active:!0}]}),r.jsx(v,{className:"mb-3",children:r.jsx(y,{children:r.jsx(h,{variant:"primary",onClick:()=>x(`/gold-programs/${a}/lots/new`),children:"Assign New Lot"})})}),r.jsx(v,{children:r.jsx(y,{children:r.jsx(b,{children:r.jsx(b.Body,{children:j.length===0?r.jsx(m,{variant:"info",children:"No lots found for this program"}):r.jsxs(I,{striped:!0,hover:!0,responsive:!0,children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"User"}),r.jsx("th",{children:"Member ID"}),r.jsx("th",{children:"Payments"}),r.jsx("th",{children:"Status"}),r.jsx("th",{children:"Actions"})]})}),r.jsx("tbody",{children:j.map(t=>{var i,n,o,d,s;return r.jsxs("tr",{children:[r.jsx("td",{children:((i=t.user)==null?void 0:i.name)||"N/A"}),r.jsx("td",{children:((n=t.user)==null?void 0:n.memberId)||"N/A"}),r.jsxs("td",{children:[((o=t.payments)==null?void 0:o.filter(c=>c.isPaid).length)||0," /",(e==null?void 0:e.durationMonths)||"N/A"]}),r.jsx("td",{children:r.jsx(S,{bg:(d=t.winners)!=null&&d.length?"success":"secondary",children:(s=t.winners)!=null&&s.length?"Winner":"Active"})}),r.jsx("td",{children:r.jsx(h,{size:"sm",variant:"info",onClick:()=>x(`/gold-programs/${a}/lots/${t.id}`),children:"View"})})]},t.id)})})]})})})})})]})};export{Q as default};
