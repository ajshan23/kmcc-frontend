import{r as t,j as e,T as R,h as P,i as k,L as M}from"./index-tNgA7nGT.js";import{P as F}from"./PageTitle-CCkfjASR.js";import{a as p}from"./api-CQpZrRPq.js";import{I as u}from"./IconifyIcon-s9Hyo8eO.js";import{l as B}from"./logo-sm-Bq_R7RX3.js";import{D as H,C as L,P as z}from"./react-beautiful-dnd.esm-DLKHTyCL.js";import{C as A}from"./Container-DAYvR0q4.js";import{R as v}from"./Row-RifMysLS.js";import{C as j}from"./Col-CnORAU6q.js";import{B as l}from"./Button-CENta7Bz.js";import{T as $}from"./Table-CZGqjMOQ.js";import{M as d}from"./Modal-XWv4zo73.js";import"./iconify-RXcx2lhF.js";import"./extends-CF3RwP-h.js";import"./raf-schd.esm-BZta1K6O.js";import"./objectSpread2-CqEmhNvY.js";import"./toPropertyKey-C9c9JG92.js";import"./tiny-invariant-BaFNuDhB.js";import"./index-8JwjhRSi.js";import"./Button-CXeEohPr.js";import"./AbstractModalHeader-_KRINFje.js";import"./useWindow-BY7h8nM3.js";import"./usePrevious-BewAhWrh.js";import"./useEventCallback-pYaJC5nB.js";import"./hasClass-B91NjqlQ.js";import"./useMergedRefs-CqwwmTTk.js";import"./NoopTransition-CWzBALoK.js";import"./DataKey-COGXBUcQ.js";import"./divWithClassName-BkIstr-m.js";const je=()=>{const[f,m]=t.useState([]),[C,b]=t.useState(!1),[h,g]=t.useState(null),[D,a]=t.useState(""),[I,o]=t.useState(!1),[N,y]=t.useState(!0);t.useEffect(()=>{w()},[]);const w=async()=>{y(!0);try{const s=await p.get("/exclusive-members");s.status===200&&m(s.data.data.members)}catch(s){console.error("Error fetching members:",s),a("Failed to fetch members"),o(!0)}finally{y(!1)}},T=s=>{g(s),b(!0)},x=()=>{b(!1),g(null)},S=async()=>{if(h)try{(await p.delete(`/exclusive-members/${h}`)).status===200&&(m(r=>r.filter(i=>i.id!==h)),a("Member deleted successfully!"),o(!0))}catch(s){console.error("Error deleting member:",s),a("Failed to delete member"),o(!0)}finally{x()}},E=async s=>{if(!s.destination)return;const r=Array.from(f),[i]=r.splice(s.source.index,1);r.splice(s.destination.index,0,i),m(r);const n=r.map(c=>c.id);try{if((await p.post("/exclusive-members/reorder-members",{memberIds:n})).status!==200)throw new Error("Failed to save new order");a("Member order updated successfully!"),o(!0)}catch(c){console.error("Error reordering members:",c),w(),a("Failed to update member order."),o(!0)}};return e.jsxs(A,{className:"p-4",children:[e.jsx(F,{title:"Exclusive Members"}),e.jsxs(R,{onClose:()=>o(!1),show:I,delay:5e3,autohide:!0,style:{position:"fixed",top:20,right:20,zIndex:9999},children:[e.jsxs(P,{children:[e.jsx("img",{src:B,alt:"brand-logo",height:"16",className:"me-1"}),e.jsx("strong",{className:"me-auto",children:"TECHMIN"})]}),e.jsx(k,{children:D})]}),e.jsx(v,{children:e.jsx(j,{xs:12,children:e.jsxs("div",{style:{width:"70vw",background:"white",border:"1px solid gray",padding:10,borderRadius:10},children:[e.jsxs(v,{className:"d-flex justify-content-between align-items-center p-2",children:[e.jsx(j,{xs:"auto",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Search",style:{width:"250px",borderRadius:10}})}),e.jsx(j,{xs:"auto",children:e.jsx(l,{type:"button",variant:"dark",style:{padding:"10px 20px",borderRadius:10},as:M,to:"/exclusive-members/new",children:"New Member"})})]}),N?e.jsx("p",{className:"text-center mt-3",children:"Loading members..."}):e.jsx(H,{onDragEnd:E,children:e.jsx(L,{droppableId:"members",children:s=>e.jsxs($,{striped:!0,bordered:!0,hover:!0,responsive:!0,className:"mt-3 text-center",...s.droppableProps,ref:s.innerRef,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Image"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Position"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[f.map((r,i)=>e.jsx(z,{draggableId:String(r.id),index:i,children:n=>e.jsxs("tr",{ref:n.innerRef,...n.draggableProps,...n.dragHandleProps,children:[e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(u,{icon:"mdi:drag",className:"me-2"}),i+1]})}),e.jsx("td",{children:r.image&&e.jsx("img",{src:r.image,alt:r.name,style:{width:"50px",height:"50px",borderRadius:"50%",objectFit:"cover"}})}),e.jsx("td",{children:r.name}),e.jsx("td",{children:r.position}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex justify-content-center gap-2",children:[e.jsx(l,{variant:"primary",size:"sm",as:M,to:`/exclusive-members/edit/${r.id}`,children:e.jsx(u,{icon:"mdi:pencil",color:"white"})}),e.jsx(l,{variant:"danger",size:"sm",onClick:()=>T(r.id),children:e.jsx(u,{icon:"ri:delete-bin-4-fill",color:"white"})})]})})]})},r.id)),s.placeholder]})]})})})]})})}),e.jsxs(d,{show:C,onHide:x,centered:!0,children:[e.jsx(d.Header,{closeButton:!0,children:e.jsx(d.Title,{children:"Delete Member"})}),e.jsx(d.Body,{children:"Are you sure you want to delete this member? This action cannot be undone."}),e.jsxs(d.Footer,{children:[e.jsx(l,{variant:"secondary",onClick:x,children:"Cancel"}),e.jsx(l,{variant:"danger",onClick:S,children:"Delete"})]})]})]})};export{je as default};
