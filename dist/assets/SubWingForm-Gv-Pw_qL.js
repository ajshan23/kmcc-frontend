import{d as P,u as k,r as n,j as e,T as B,h as D,i as M}from"./index-tNgA7nGT.js";import"./iconify-RXcx2lhF.js";import{a as x}from"./api-CQpZrRPq.js";import{P as R}from"./PageTitle-CCkfjASR.js";import{l as $}from"./logo-sm-Bq_R7RX3.js";import{R as N}from"./Row-RifMysLS.js";import{C as j}from"./Col-CnORAU6q.js";import{C as q,a as U}from"./Card-B1tYBRGQ.js";import{F as s}from"./Form-Dv6oRs5P.js";import{B as T}from"./Button-CENta7Bz.js";import"./CardHeaderContext-BtYRO3IT.js";import"./divWithClassName-BkIstr-m.js";import"./FormCheck-Bgt48iIR.js";import"./FormContext-DD_I2OzJ.js";import"./FormCheckInput-B2vMIfyo.js";import"./ElementChildren-DV_13d0k.js";import"./FormControl-CbvVdWru.js";import"./FormLabel-C90nlSEw.js";import"./Button-CXeEohPr.js";const ie=()=>{const{id:d}=P(),o=!!d,b=k(),[E,i]=n.useState(!1),[W,l]=n.useState(""),[m,f]=n.useState(""),[C,w]=n.useState(""),[u,p]=n.useState("#FFFFFF"),[c,h]=n.useState("#000000"),[y,G]=n.useState(null),[v,S]=n.useState(null),[F,g]=n.useState(!1);n.useEffect(()=>{o&&(async()=>{try{const t=await x.get(`/sub-wing/${d}`);if(t.status===200){const r=t.data.data;f(r.name),w(r.description||""),p(r.backgroundColor),h(r.mainColor),S(r.icon)}}catch(t){console.error("Error fetching sub-wing:",t),l("Failed to load sub-wing data"),i(!0)}})()},[d,o]);const I=a=>{const t=a.target.files[0];if(t){if(t.type!=="image/svg+xml"){l("Only SVG files are allowed for the icon"),i(!0);return}G(t);const r=new FileReader;r.onload=()=>{S(r.result)},r.readAsDataURL(t)}},L=async a=>{if(a.preventDefault(),g(!0),!m){l("Sub-wing name is required"),i(!0),g(!1);return}const t=new FormData;t.append("name",m),t.append("description",C),t.append("backgroundColor",u),t.append("mainColor",c),y&&t.append("icon",y);try{let r;o?r=await x.put(`/sub-wing/${d}`,t,{headers:{"Content-Type":"multipart/form-data"}}):r=await x.post("/sub-wing",t,{headers:{"Content-Type":"multipart/form-data"}}),r.status===(o?200:201)&&(l(`Sub-wing ${o?"updated":"created"} successfully!`),i(!0),setTimeout(()=>{b("/sub-wing")},1500))}catch(r){console.error(`Error ${o?"updating":"creating"} sub-wing:`,r),l(`Failed to ${o?"update":"create"} sub-wing. Please try again.`),i(!0)}finally{g(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(R,{title:o?"Edit Sub-Wing":"Create Sub-Wing"}),e.jsxs(B,{onClose:()=>i(!1),show:E,delay:3e3,autohide:!0,style:{position:"fixed",top:20,right:20,zIndex:9999},children:[e.jsxs(D,{children:[e.jsx("img",{src:$,alt:"brand-logo",height:"16",className:"me-1"}),e.jsx("strong",{className:"me-auto",children:"KMCC"})]}),e.jsx(M,{children:W})]}),e.jsx(N,{children:e.jsx(j,{xs:12,children:e.jsx(q,{children:e.jsx(U,{children:e.jsxs(s,{onSubmit:L,children:[e.jsxs(N,{children:[e.jsxs(j,{md:6,children:[e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:"Sub-Wing Name *"}),e.jsx(s.Control,{type:"text",value:m,onChange:a=>f(a.target.value),placeholder:"Enter sub-wing name",required:!0})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:"Description"}),e.jsx(s.Control,{as:"textarea",rows:3,value:C,onChange:a=>w(a.target.value),placeholder:"Enter sub-wing description (optional)"})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:"Background Color *"}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(s.Control,{type:"color",value:u,onChange:a=>p(a.target.value),style:{width:"60px",height:"40px"}}),e.jsx(s.Control,{type:"text",value:u,onChange:a=>p(a.target.value),className:"ms-2",placeholder:"#FFFFFF",required:!0})]})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:"Main Color *"}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(s.Control,{type:"color",value:c,onChange:a=>h(a.target.value),style:{width:"60px",height:"40px"}}),e.jsx(s.Control,{type:"text",value:c,onChange:a=>h(a.target.value),className:"ms-2",placeholder:"#000000",required:!0})]})]})]}),e.jsxs(j,{md:6,children:[e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:"Icon (SVG only)"}),e.jsx(s.Control,{type:"file",accept:"image/svg+xml",onChange:I}),e.jsx(s.Text,{className:"text-muted",children:"Optional SVG icon for the sub-wing"}),v&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{children:"Preview:"}),e.jsx("img",{src:v,alt:"Icon preview",style:{height:"100px"}})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h5",{children:"Color Preview"}),e.jsx("div",{style:{backgroundColor:u,color:c,padding:"20px",borderRadius:"8px",border:`1px solid ${c}`},children:e.jsx("p",{className:"mb-0",children:"This is how your sub-wing colors will look together."})})]})]})]}),e.jsxs("div",{className:"d-flex justify-content-end mt-4",children:[e.jsx(T,{variant:"secondary",className:"me-2",onClick:()=>b("/sub-wing"),children:"Cancel"}),e.jsx(T,{variant:"primary",type:"submit",disabled:F,children:F?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"}),o?"Updating...":"Creating..."]}):o?"Update Sub-Wing":"Create Sub-Wing"})]})]})})})})})]})};export{ie as default};
