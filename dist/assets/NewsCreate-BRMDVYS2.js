import{a as H,r as o,j as e,T as D,g as M,h as V}from"./index-DPuNUjLg.js";import{l as k}from"./cropper-MwML4X9w.js";import{I as z}from"./IconifyIcon-CRmgpD-A.js";import{a as J}from"./api-alN533tX.js";import{P as O}from"./PageTitle-CqWn3q0T.js";import{l as q}from"./logo-sm-DeRMNujR.js";import{R as y,C as p}from"./Row-CcHO1i0D.js";import{C as K}from"./Card-BZ6UHl2I.js";import{C as Q}from"./CardBody-CGT1fL4u.js";import{F as t}from"./Form-LPEeaXcj.js";import{B as W}from"./Button-BnjsKorX.js";import"./iconify-CwHMartp.js";import"./CardHeaderContext-DMcAJQTf.js";import"./divWithClassName-CR8nEuA8.js";import"./FormCheck-KaS-eO03.js";import"./FormContext-BlvwWdud.js";import"./ElementChildren-ChJp8XjW.js";import"./FormControl-bLwLOBBO.js";import"./FormLabel-B_CILb4g.js";import"./Button-CXwj5S0n.js";const xe=()=>{const w=H(),[C,n]=o.useState(!1),[b,l]=o.useState(""),[X,i]=o.useState("success"),[d,N]=o.useState(null),[S,I]=o.useState(null),[m,v]=o.useState(null),[c,T]=o.useState(null),[h,R]=o.useState(""),[u,F]=o.useState(""),[g,U]=o.useState(""),[x,E]=o.useState(""),j=o.useRef(null),f=402/335,L=s=>{const r=s.target.files[0];if(r){const a=new FileReader;a.onload=()=>N(a.result),a.readAsDataURL(r)}},A=s=>{const r=s.target.files[0];if(r){const a=new Blob([r],{type:r.type});I(a),v(URL.createObjectURL(a))}},B=()=>{var r;const s=(r=j.current)==null?void 0:r.cropper;s&&s.getCroppedCanvas().toBlob(a=>T(a))},G=async()=>{if(!c){l("Please crop the image first."),i("danger"),n(!0);return}const s=new File([c],"banner-image.png",{type:"image/png"}),r=new File([S],"author-image.png",{type:"image/png"}),a=new FormData;a.append("image",s),a.append("authorImage",r),a.append("type",h),a.append("heading",u),a.append("author",g),a.append("body",x);try{if((await J.post("/news",a,{headers:{"Content-Type":"multipart/form-data"}})).status===201)l("News created successfully."),i("success"),n(!0),setTimeout(()=>w("/news"),2e3);else throw new Error("Failed to upload news.")}catch{l("Error uploading news."),i("danger"),n(!0)}};return e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"New News"}),e.jsxs(D,{onClose:()=>n(!1),show:C,delay:2e3,autohide:!0,style:{position:"fixed",top:20,right:20,zIndex:9999},children:[e.jsxs(M,{children:[e.jsx("img",{src:q,alt:"brand-logo",height:"16",className:"me-1"}),e.jsx("strong",{className:"me-auto",children:"TECHMIN"})]}),e.jsx(V,{children:b})]}),e.jsx(y,{children:e.jsx(p,{xs:12,children:e.jsx(K,{children:e.jsx(Q,{children:e.jsxs(y,{children:[e.jsxs(p,{lg:9,children:[e.jsxs(t.Group,{className:"mb-3",children:[e.jsx(t.Label,{children:"Upload Job Image (402x335)"}),e.jsx(t.Control,{type:"file",accept:"image/*",onChange:L})]}),d&&e.jsx(e.Fragment,{children:e.jsx(k,{src:d,style:{height:400,width:"100%"},initialAspectRatio:f,aspectRatio:f,guides:!1,crop:B,ref:j})}),e.jsxs(t.Group,{className:"mb-3",children:[e.jsx(t.Label,{children:"Upload Author Image"}),e.jsx(t.Control,{type:"file",accept:"image/*",onChange:A}),m&&e.jsx("img",{src:m,alt:"Preview",width:150,className:"mt-3"})]})]}),e.jsxs(p,{lg:3,children:[e.jsxs(t.Group,{className:"mb-3",children:[e.jsx(t.Label,{children:"Type"}),e.jsx(t.Control,{type:"text",value:h,onChange:s=>R(s.target.value),placeholder:"Enter type"})]}),e.jsxs(t.Group,{className:"mb-3",children:[e.jsx(t.Label,{children:"Heading"}),e.jsx(t.Control,{type:"text",value:u,onChange:s=>F(s.target.value),placeholder:"Enter heading"})]}),e.jsxs(t.Group,{className:"mb-3",children:[e.jsx(t.Label,{children:"Author"}),e.jsx(t.Control,{type:"text",value:g,onChange:s=>U(s.target.value),placeholder:"Enter author name"})]}),e.jsxs(t.Group,{className:"mb-3",children:[e.jsx(t.Label,{children:"Body"}),e.jsx(t.Control,{type:"text",value:x,onChange:s=>E(s.target.value),placeholder:"Enter news content"})]}),e.jsxs(W,{variant:"primary",className:"w-100 mt-3",onClick:G,disabled:!c,children:[e.jsx(z,{icon:"mdi:upload"})," Create News"]})]})]})})})})})]})};export{xe as default};
