import{r as n,j as e}from"./index-DZiXj8TR.js";import{a as f}from"./api-CQpZrRPq.js";import"./iconify-DkiI8ZpJ.js";import{l as I}from"./cropper-BFtYBArb.js";import{F as a}from"./Form-BpKd490-.js";import{R as M,C as j}from"./Row-DDbPR_EX.js";import{F as l}from"./FormControl-CYWbfcub.js";import{C as E,a as U}from"./Card-CSmnExEW.js";import{B as b}from"./Button-BxiFzc-j.js";const O=({committeeId:g,onSuccess:C,onCancel:y,initialData:o})=>{const[c,v]=n.useState((o==null?void 0:o.name)||""),[i,N]=n.useState((o==null?void 0:o.position)||""),[u,R]=n.useState(null),[d,F]=n.useState(null),[x,p]=n.useState(!1),h=n.useRef(null),m=!!o,S=t=>{const s=t.target.files[0];if(s){const r=new FileReader;r.onload=()=>{R(r.result)},r.readAsDataURL(s)}},w=()=>{var s;const t=(s=h.current)==null?void 0:s.cropper;t&&t.getCroppedCanvas().toBlob(r=>{F(r)})},L=async t=>{if(t.preventDefault(),p(!0),!c||!i){alert("Name and position are required"),p(!1);return}const s=new FormData;s.append("name",c),s.append("position",i),d&&s.append("image",d,"member.jpg");try{let r;m?r=await f.put(`/constitution-committees/members/${o.id}`,s,{headers:{"Content-Type":"multipart/form-data"}}):r=await f.post(`/constitution-committees/${g}/members`,s,{headers:{"Content-Type":"multipart/form-data"}}),r.status===(m?200:201)&&C(r.data.data)}catch(r){console.error("Error adding member:",r),alert(`Failed to ${m?"update":"add"} member`)}finally{p(!1)}};return e.jsxs(a,{onSubmit:L,children:[e.jsxs(M,{children:[e.jsxs(j,{md:6,children:[e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Member Name *"}),e.jsx(l,{type:"text",value:c,onChange:t=>v(t.target.value),placeholder:"Enter member name",required:!0})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Position *"}),e.jsx(l,{type:"text",value:i,onChange:t=>N(t.target.value),placeholder:"Enter position",required:!0})]})]}),e.jsxs(j,{md:6,children:[e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Member Image (163x231 recommended)"}),e.jsx(l,{type:"file",accept:"image/*",onChange:S})]}),u&&e.jsx(E,{className:"mb-3",children:e.jsx(U,{children:e.jsx(I,{src:u,style:{height:400,width:"100%"},initialAspectRatio:163/231,aspectRatio:163/231,guides:!1,crop:w,ref:h})})}),d&&e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:"Cropped Preview:"}),e.jsx("img",{src:URL.createObjectURL(d),alt:"Cropped preview",style:{maxHeight:"200px"}})]})]})]}),e.jsxs("div",{className:"d-flex justify-content-end",children:[e.jsx(b,{variant:"secondary",className:"me-2",onClick:y,children:"Cancel"}),e.jsx(b,{variant:"primary",type:"submit",disabled:x,children:x?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"}),m?"Updating...":"Adding..."]}):m?"Update Member":"Add Member"})]})]})};export{O as M};
