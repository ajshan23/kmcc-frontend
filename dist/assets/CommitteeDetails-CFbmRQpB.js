import{d as P,r as s,j as e,T as R,h as $,i as z,L as g}from"./index-CfNT85tM.js";import{P as F}from"./PageTitle-D_HZ265t.js";import{a as f}from"./api-BAouzzCb.js";import{I as j}from"./IconifyIcon-0D5ZULyN.js";import{l as K}from"./logo-sm-DeRMNujR.js";import{M as q}from"./MemberForm-CaN3sAy2.js";import{R as M,C as N}from"./Row-pUvplkm2.js";import{C as p}from"./Card-BxC9ygCX.js";import{B as G}from"./Badge-Dxw4lbGc.js";import{B as o}from"./Button-DmtmunvM.js";import{T as J}from"./Tabs-DuqMh3co.js";import{T}from"./Tab-LnW0qGdn.js";import{T as v}from"./Table-DAjJSobz.js";import{M as i}from"./Modal-xL1nFGJh.js";import"./iconify-Dnpwx_79.js";import"./cropper-pWBWfG95.js";import"./Form-BPTIrVzf.js";import"./FormCheck-DtwGqKiM.js";import"./FormContext-CAGAzZgQ.js";import"./ElementChildren-ShUlXlPu.js";import"./FormControl-dmhg-08h.js";import"./FormLabel-CoJ0DtNH.js";import"./CardBody-TiP-bp9B.js";import"./CardHeaderContext-DMh6jMut.js";import"./divWithClassName-MTQsKDs0.js";import"./Button-AVmPP0NH.js";import"./hook-9Fc7o0VZ.js";import"./extends-CF3RwP-h.js";import"./TabPane-BrrWKCGZ.js";import"./Nav-DYsxPVmg.js";import"./DataKey-COGXBUcQ.js";import"./NavContext-j2YYlu8f.js";import"./useMergedRefs-eYDo2WSS.js";import"./NavItem-lRUtfKNV.js";import"./useEventCallback-B2meNR0i.js";import"./NavbarContext-Wz35b8Be.js";import"./NavLink-BRKSwZly.js";import"./Anchor-Kzj3Lb_I.js";import"./NoopTransition-BANWBBX8.js";import"./AbstractModalHeader-o6WA7pR6.js";import"./useWindow-BmY1pYqs.js";import"./usePrevious-TUyZfySc.js";import"./hasClass-BQeUoxnv.js";const He=()=>{const{committeeId:a}=P(),[n,w]=s.useState(null),[c,u]=s.useState([]),[C,b]=s.useState(!0),[S,l]=s.useState(!1),[D,m]=s.useState(""),[B,h]=s.useState(!1),[A,x]=s.useState(!1),[r,y]=s.useState(null),[I,E]=s.useState("details");s.useEffect(()=>{(async()=>{try{b(!0);const[d,L]=await Promise.all([f.get(`/constitution-committees/${a}`),f.get(`/constitution-committees/${a}/members`)]);w(d.data.data),u(L.data.data)}catch(d){console.error("Error fetching committee details:",d),m("Failed to load committee details"),l(!0)}finally{b(!1)}})()},[a]);const k=t=>{u([...c,t]),h(!1),m("Member added successfully"),l(!0)},H=async()=>{if(r)try{await f.delete(`/constitution-committees/members/${r.id}`),u(c.filter(t=>t.id!==r.id)),m("Member deleted successfully"),l(!0)}catch(t){console.error("Error deleting member:",t),m("Failed to delete member"),l(!0)}finally{x(!1),y(null)}};return C?e.jsx("div",{className:"d-flex justify-content-center p-5",children:"Loading..."}):n?e.jsxs("div",{className:"d-flex p-4",children:[e.jsx(F,{title:"Committee Details"}),e.jsxs(R,{onClose:()=>l(!1),show:S,delay:5e3,autohide:!0,style:{position:"fixed",top:20,right:20,zIndex:9999},children:[e.jsxs($,{children:[e.jsx("img",{src:K,alt:"brand-logo",height:"16",className:"me-1"}),e.jsx("strong",{className:"me-auto",children:"KMCC"})]}),e.jsx(z,{children:D})]}),e.jsx(M,{className:"w-100",children:e.jsx(N,{xs:12,children:e.jsx(p,{children:e.jsxs(p.Body,{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsxs("h4",{children:[n.title,e.jsxs(G,{bg:"primary",className:"ms-2",children:[c.length," Members"]})]}),e.jsxs("div",{children:[e.jsxs(o,{variant:"primary",className:"me-2",as:g,to:`/constitution-committees/edit/${a}`,children:[e.jsx(j,{icon:"mdi:pencil",className:"me-1"}),"Edit"]}),e.jsxs(o,{variant:"success",onClick:()=>h(!0),children:[e.jsx(j,{icon:"mdi:plus",className:"me-1"}),"Add Member"]})]})]}),e.jsxs(J,{activeKey:I,onSelect:t=>E(t),className:"mb-3",children:[e.jsx(T,{eventKey:"details",title:"Details",children:e.jsx(M,{className:"mt-3",children:e.jsx(N,{md:12,children:e.jsx(p,{children:e.jsxs(p.Body,{children:[e.jsx("h5",{children:"Committee Information"}),e.jsx(v,{bordered:!0,children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:"Title"}),e.jsx("td",{children:n.title})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Description"}),e.jsx("td",{children:n.description||e.jsx("span",{className:"text-muted",children:"No description"})})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Created At"}),e.jsx("td",{children:new Date(n.createdAt).toLocaleString()})]})]})})]})})})})}),e.jsx(T,{eventKey:"members",title:"Members",children:e.jsx("div",{className:"mt-3",children:e.jsxs(v,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Position"}),e.jsx("th",{children:"Image"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:c.map((t,d)=>e.jsxs("tr",{children:[e.jsx("td",{children:d+1}),e.jsx("td",{children:t.name}),e.jsx("td",{children:t.position}),e.jsx("td",{children:t.image?e.jsx("img",{src:t.image,alt:t.name,style:{height:"50px"}}):e.jsx("span",{className:"text-muted",children:"No image"})}),e.jsxs("td",{children:[e.jsx(o,{variant:"primary",size:"sm",className:"me-2",as:g,to:`/constitution-committees/members/edit/${t.id}`,children:e.jsx(j,{icon:"mdi:pencil",color:"white"})}),e.jsx(o,{variant:"danger",size:"sm",onClick:()=>{y(t),x(!0)},children:e.jsx(j,{icon:"mdi:delete",color:"white"})})]})]},t.id))})]})})})]})]})})})}),e.jsxs(i,{show:B,onHide:()=>h(!1),size:"lg",children:[e.jsx(i.Header,{closeButton:!0,children:e.jsx(i.Title,{children:"Add New Member"})}),e.jsx(i.Body,{children:e.jsx(q,{committeeId:a,onSuccess:k,onCancel:()=>h(!1)})})]}),e.jsxs(i,{show:A,onHide:()=>x(!1),centered:!0,children:[e.jsx(i.Header,{closeButton:!0,children:e.jsx(i.Title,{children:"Delete Member"})}),e.jsxs(i.Body,{children:['Are you sure you want to delete "',r==null?void 0:r.name,'"? This action cannot be undone.']}),e.jsxs(i.Footer,{children:[e.jsx(o,{variant:"secondary",onClick:()=>x(!1),children:"Cancel"}),e.jsx(o,{variant:"danger",onClick:H,children:"Delete"})]})]})]}):e.jsx("div",{className:"d-flex justify-content-center p-5",children:"Committee not found"})};export{He as default};
