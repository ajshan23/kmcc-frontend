import{r as v,u as y,a as S,b as w,c as I,j as e}from"./index-oZOXagb6.js";import{A as P}from"./AuthLogo-CUvpMCkn.js";import{u as C}from"./index.esm-dRZpoxBI.js";import{o as F,c as L,a as d}from"./index.esm-h1-oenyw.js";import{T as A}from"./TextFormInput-CDpbleWq.js";import{P as q}from"./PasswordFormInput-BoYcbYjq.js";import{a as k}from"./api-CQpZrRPq.js";import{F as R}from"./Form-RlP0Rjz3.js";import{B as T}from"./Button-BjDVT7iL.js";import{S as D}from"./Spinner-CWr4oDD1.js";import{a as E}from"./auth-img-Z-U4pW7a.js";import{C as M}from"./Container-V4E40MkV.js";import{R as u}from"./Row-BRTb4Q3x.js";import{C as o}from"./Col-CliyWdof.js";import{C as B}from"./Card-CByQ_iKt.js";import"./logo-CYvjuPGo.js";import"./logo-dark-CImkbYvP.js";import"./FormContext-Bl_nBIxk.js";import"./FormLabel-Bo8_nfdL.js";import"./FormControl-7vMxEVbB.js";import"./IconifyIcon-DvFk5hCx.js";import"./iconify-DRmFi74x.js";import"./FormCheck-Bhm0cQQY.js";import"./FormCheckInput-BXTlCTZ2.js";import"./ElementChildren-B0W_E0jD.js";import"./Button-B8bHFfcq.js";import"./CardHeaderContext-DZwIQcmL.js";import"./divWithClassName-D5RmpbwJ.js";const $=L({identifier:d().required("Please enter your Iqama Number or Member ID"),password:d().required("Please enter your password")}),z=()=>{const[t,i]=v.useState(!1),p=y(),[g]=S(),{saveSession:f}=w(),{showNotification:r}=I(),{control:n,handleSubmit:x}=C({resolver:F($),defaultValues:{identifier:"",password:""}}),h=async j=>{var m,c,l;i(!0);try{const{data:s}=await k.post("/auth/signin",j);if(s!=null&&s.success&&((m=s==null?void 0:s.data)!=null&&m.token)){const{user:a,token:b}=s.data;if(!a.isAdmin&&!a.isSuperAdmin){r({message:"Access denied! You are not an admin.",variant:"danger"});return}f({token:b,user:a}),r({message:"Successfully logged in. Redirecting....",variant:"success"});const N=g.get("redirectTo")||"/";setTimeout(()=>p(N),500)}else r({message:s.message||"Unexpected response. Please try again.",variant:"danger"})}catch(s){console.error("Login error:",s),r({message:((l=(c=s.response)==null?void 0:c.data)==null?void 0:l.message)||"Login failed. Please try again.",variant:"danger"})}finally{i(!1)}};return e.jsxs(R,{onSubmit:x(h),children:[e.jsx(A,{name:"identifier",control:n,label:"Iqama Number or Member ID"}),e.jsx(q,{name:"password",control:n,label:"Password"}),e.jsx(T,{type:"submit",disabled:t,className:"w-100 mt-3",children:t?e.jsx(D,{animation:"border",size:"sm"}):"Sign In"})]})},fe=()=>e.jsx("div",{className:"account-pages p-sm-5 position-relative",children:e.jsx(M,{children:e.jsx(u,{className:"justify-content-center",children:e.jsx(o,{xxl:9,lg:11,children:e.jsx(B,{className:"overflow-hidden",children:e.jsxs(u,{className:"g-0",children:[e.jsx(o,{lg:6,children:e.jsxs("div",{className:"d-flex flex-column h-75",children:[e.jsx(P,{}),e.jsxs("div",{className:"p-4 my-auto text-center",children:[e.jsx("h4",{className:"fs-20",children:"Sign In"}),e.jsx("p",{className:"text-muted mb-4",children:"Enter your Iqama Number or Member ID and password to access your account."}),e.jsx(z,{})]})]})}),e.jsx(o,{lg:6,className:"d-none d-lg-block",children:e.jsx("img",{src:E,alt:"image",className:"img-fluid rounded h-100"})})]})})})})})});export{fe as default};
