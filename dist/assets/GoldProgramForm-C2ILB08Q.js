import{u as T,d as v,r as o,j as a,T as S,h as w,i as E}from"./index-DKQPNifM.js";import{a as x}from"./api-BAouzzCb.js";import{P as G}from"./PageTitle-CRu15oFp.js";import{l as N}from"./logo-sm-DeRMNujR.js";import{I as F}from"./IconifyIcon-Cz5kna7C.js";import{R as I,C as R}from"./Row-Z0t_gNsB.js";import{C as B}from"./Card-D59v7jI9.js";import{C as D}from"./CardBody-DcEFUZwh.js";import{F as r}from"./Form-msQAt-qp.js";import{B as j}from"./Button-CJm9uxN6.js";import"./iconify-BZ3wrvzO.js";import"./CardHeaderContext-kdxd1e-2.js";import"./divWithClassName-CmLA-jjW.js";import"./FormCheck-BrYDrZ1e.js";import"./FormContext-wZ54zJwb.js";import"./FormCheckInput-B_azkgLI.js";import"./ElementChildren-CJ8krY86.js";import"./FormControl-BA3XJbTj.js";import"./FormLabel-BnU1TUmx.js";import"./Button-dGMJGo8F.js";const ea=()=>{const l=T(),{id:m}=v(),[y,i]=o.useState(!1),[P,c]=o.useState(""),[n,p]=o.useState(!1),[e,C]=o.useState(!1),[g,u]=o.useState({name:"",description:""});o.useEffect(()=>{m&&(async()=>{p(!0);try{const s=await x.get(`/gold/${m}`);s.status===200&&(u({name:s.data.data.name,description:s.data.data.description||""}),C(!0))}catch(s){console.error("Error fetching program:",s),c("Failed to load program data."),i(!0),l("/gold-programs")}finally{p(!1)}})()},[m,l]);const h=d=>{const{name:s,value:t}=d.target;u(f=>({...f,[s]:t}))},b=async()=>{var d,s;if(!g.name){c("Program name is required"),setToastVariant("danger"),i(!0);return}p(!0);try{const t=e?`/gold/${m}`:"/gold/start",L=await x[e?"put":"post"](t,g);c(e?"Program updated successfully":"Program started successfully"),i(!0),setTimeout(()=>l("/gold-programs"),1500)}catch(t){console.error("Error:",t),c(((s=(d=t.response)==null?void 0:d.data)==null?void 0:s.message)||`Failed to ${e?"update":"start"} program`),i(!0)}finally{p(!1)}};return a.jsxs(a.Fragment,{children:[a.jsx(G,{title:e?"Edit Gold Program":"New Gold Program"}),a.jsxs(S,{onClose:()=>i(!1),show:y,delay:3e3,autohide:!0,style:{position:"fixed",top:20,right:20,zIndex:9999},children:[a.jsxs(w,{children:[a.jsx("img",{src:N,alt:"brand-logo",height:"16",className:"me-1"}),a.jsx("strong",{className:"me-auto",children:"GOLD PROGRAM"})]}),a.jsx(E,{children:P})]}),a.jsx(I,{children:a.jsx(R,{xs:12,children:a.jsx(B,{children:a.jsx(D,{children:a.jsxs(r,{children:[a.jsxs(r.Group,{className:"mb-3",children:[a.jsx(r.Label,{children:"Program Name*"}),a.jsx(r.Control,{type:"text",name:"name",value:g.name,onChange:h,placeholder:"Gold Investment 2024",disabled:n})]}),a.jsxs(r.Group,{className:"mb-3",children:[a.jsx(r.Label,{children:"Description"}),a.jsx(r.Control,{as:"textarea",rows:3,name:"description",value:g.description,onChange:h,placeholder:"Program details...",disabled:n})]}),a.jsxs("div",{className:"d-flex gap-2",children:[a.jsx(j,{variant:"secondary",onClick:()=>l("/gold-programs"),disabled:n,children:"Cancel"}),a.jsxs(j,{variant:"primary",onClick:b,disabled:n,children:[a.jsx(F,{icon:e?"mdi:pencil":"mdi:plus"})," ",n?"Processing...":e?"Update":"Start Program"]})]})]})})})})})]})};export{ea as default};
