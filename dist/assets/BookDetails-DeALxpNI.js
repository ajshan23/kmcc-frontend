import{d as v,r as a,j as e,T as C,h as T,i as D,L as A}from"./index-CWxK9h8P.js";import{P as E}from"./PageTitle-DWsonpDE.js";import{a as x}from"./api-CQpZrRPq.js";import{I as j}from"./IconifyIcon-CC4OnH-e.js";import{l as I}from"./logo-sm-Bq_R7RX3.js";import{R as f}from"./Row-C2I4GQ41.js";import{C as p}from"./Col-BXHEcCf6.js";import{C as i}from"./Card-DZFDkilJ.js";import{B as d}from"./Button-CQasjNBg.js";import{T as S}from"./Table-DywIZmfJ.js";import{M as c}from"./Modal-BvhR9nwq.js";import"./iconify-BL2rH4cv.js";import"./CardHeaderContext-ijBDOs9Q.js";import"./divWithClassName-B3-UALgE.js";import"./Button-Rbr09trj.js";import"./AbstractModalHeader-Dg8cC4yC.js";import"./useWindow-BSjvxul1.js";import"./usePrevious-f1lRgY9w.js";import"./useEventCallback-FbBVX3K_.js";import"./hasClass-Ce-Nhihp.js";import"./useMergedRefs-7j0TLQWM.js";import"./NoopTransition-N-W7GiHR.js";import"./DataKey-COGXBUcQ.js";const oe=()=>{const{id:n}=v(),[t,y]=a.useState(null),[g,u]=a.useState(!0),[k,l]=a.useState(!1),[w,h]=a.useState(""),[b,m]=a.useState(!1);a.useEffect(()=>{(async()=>{try{u(!0);const s=await x.get(`/book/${n}`);s.status===200&&y(s.data.data)}catch(s){console.error("Error fetching book details:",s),h("Failed to load book details"),l(!0)}finally{u(!1)}})()},[n]);const N=async()=>{try{const o=await x.get(`/book/${n}/download`,{responseType:"blob"});if(!o.data)throw new Error("No data received");const s=window.URL.createObjectURL(new Blob([o.data])),r=document.createElement("a");r.href=s,r.setAttribute("download",`${(t==null?void 0:t.title)||"book"}.pdf`),document.body.appendChild(r),r.click(),r.parentNode.removeChild(r)}catch(o){console.error("Error downloading book:",o),h("Failed to download book"),l(!0)}},B=async()=>{try{await x.delete(`/book/${n}`),h("Book deleted successfully"),l(!0),setTimeout(()=>{window.location.href="/book"},1500)}catch(o){console.error("Error deleting book:",o),h("Failed to delete book"),l(!0)}finally{m(!1)}};return g?e.jsx("div",{className:"d-flex justify-content-center p-5",children:"Loading..."}):t?e.jsxs("div",{className:"d-flex p-4",children:[e.jsx(E,{title:"Book Details"}),e.jsxs(C,{onClose:()=>l(!1),show:k,delay:5e3,autohide:!0,style:{position:"fixed",top:20,right:20,zIndex:9999},children:[e.jsxs(T,{children:[e.jsx("img",{src:I,alt:"brand-logo",height:"16",className:"me-1"}),e.jsx("strong",{className:"me-auto",children:"KMCC"})]}),e.jsx(D,{children:w})]}),e.jsx(f,{className:"w-100",children:e.jsx(p,{xs:12,children:e.jsx(i,{children:e.jsxs(i.Body,{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsx("h4",{children:t.title||"Untitled Book"}),e.jsxs("div",{children:[e.jsxs(d,{variant:"primary",className:"me-2",as:A,to:`/book/edit/${n}`,children:[e.jsx(j,{icon:"mdi:pencil",className:"me-1"}),"Edit"]}),e.jsxs(d,{variant:"success",className:"me-2",onClick:N,children:[e.jsx(j,{icon:"mdi:download",className:"me-1"}),"Download PDF"]}),e.jsxs(d,{variant:"danger",onClick:()=>m(!0),children:[e.jsx(j,{icon:"mdi:delete",className:"me-1"}),"Delete"]})]})]}),e.jsxs(f,{children:[e.jsx(p,{md:4,children:e.jsx(i,{children:e.jsx(i.Body,{className:"text-center",children:t.coverImage?e.jsx("img",{src:t.coverImage,alt:t.title,style:{maxHeight:"300px",marginBottom:"20px"}}):e.jsx("div",{style:{height:"150px",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"20px"},children:e.jsx("span",{className:"text-muted",children:"No cover image"})})})})}),e.jsx(p,{md:8,children:e.jsx(i,{children:e.jsxs(i.Body,{children:[e.jsx("h5",{children:"Book Information"}),e.jsx(S,{bordered:!0,children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:"Title"}),e.jsx("td",{children:t.title||"N/A"})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Author"}),e.jsx("td",{children:t.author||"N/A"})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Description"}),e.jsx("td",{children:t.description||e.jsx("span",{className:"text-muted",children:"No description"})})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Added On"}),e.jsx("td",{children:t.createdAt?new Date(t.createdAt).toLocaleDateString():"N/A"})]})]})})]})})})]})]})})})}),e.jsxs(c,{show:b,onHide:()=>m(!1),centered:!0,children:[e.jsx(c.Header,{closeButton:!0,children:e.jsx(c.Title,{children:"Delete Book"})}),e.jsxs(c.Body,{children:['Are you sure you want to delete "',t.title||"this book",'"? This action cannot be undone.']}),e.jsxs(c.Footer,{children:[e.jsx(d,{variant:"secondary",onClick:()=>m(!1),children:"Cancel"}),e.jsx(d,{variant:"danger",onClick:B,children:"Delete"})]})]})]}):e.jsx("div",{className:"d-flex justify-content-center p-5",children:"Book not found"})};export{oe as default};
