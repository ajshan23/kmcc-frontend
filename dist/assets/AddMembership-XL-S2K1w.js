import{u as M,d as E,r as i,j as e,T as S,h as T,i as q}from"./index-VzOysTvz.js";import{a as x}from"./api-CQpZrRPq.js";import{P as w}from"./PageTitle-Amhy0bFR.js";import{l as F}from"./logo-sm-Bq_R7RX3.js";import{I as L}from"./IconifyIcon-LG_YGEyj.js";import{R as j}from"./Row-CIJAanl2.js";import{C as G}from"./Col-acre0jtq.js";import{C as D,a as P}from"./Card-8_upJKoj.js";import{F as a}from"./Form-C8HP60Dx.js";import{B as f}from"./Button-BylzbV0n.js";import"./iconify-SC4jjo5u.js";import"./CardHeaderContext-3yahSJVu.js";import"./divWithClassName-C0MZErg6.js";import"./FormCheck-Bml2pTGy.js";import"./FormContext-BLUp5kA5.js";import"./ElementChildren-OK_jdl1i.js";import"./FormControl-BCWTN-hW.js";import"./FormLabel-DMVimlsS.js";import"./Button-BedQCe8q.js";const se=()=>{const c=M(),{id:u}=E(),[g,d]=i.useState(!1),[C,h]=i.useState(""),[A,p]=i.useState("success"),[r,b]=i.useState(!1),[o,y]=i.useState(!1),[t,N]=i.useState({memberId:"",iqamaNumber:"",name:"",phoneNumber:"",status:"active",areaName:""});i.useEffect(()=>{u&&(async()=>{b(!0);try{const s=await x.get(`/admin/memberships/${u}`);s.status===200&&(N({memberId:s.data.data.memberId,iqamaNumber:s.data.data.iqamaNumber,name:s.data.data.name,phoneNumber:s.data.data.phoneNumber||"",status:s.data.data.status,areaName:s.data.data.areaName||""}),y(!0))}catch(s){console.error("Error fetching membership:",s),h("Failed to load membership data."),p("danger"),d(!0),c("/membership")}finally{b(!1)}})()},[u,c]);const n=l=>{const{name:s,value:m}=l.target;N(v=>({...v,[s]:m}))},I=async()=>{var l,s;if(!t.memberId||!t.iqamaNumber||!t.name){h("Member ID, Iqama Number, and Name are required."),p("danger"),d(!0);return}b(!0);try{let m;o?m=await x.put(`/admin/memberships/${u}`,t):m=await x.post("/admin/memberships",t),(m.status===200||m.status===201)&&(h(o?"Membership updated successfully.":"Membership added successfully."),p("success"),d(!0),setTimeout(()=>c("/membership"),2e3))}catch(m){console.error("Error:",m),h(((s=(l=m.response)==null?void 0:l.data)==null?void 0:s.message)||`Failed to ${o?"update":"add"} membership.`),p("danger"),d(!0)}finally{b(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(w,{title:o?"Edit Membership":"New Membership"}),e.jsxs(S,{onClose:()=>d(!1),show:g,delay:3e3,autohide:!0,style:{position:"fixed",top:20,right:20,zIndex:9999},children:[e.jsxs(T,{children:[e.jsx("img",{src:F,alt:"brand-logo",height:"16",className:"me-1"}),e.jsx("strong",{className:"me-auto",children:"TECHMIN"})]}),e.jsx(q,{children:C})]}),e.jsx(j,{children:e.jsx(G,{xs:12,children:e.jsx(D,{children:e.jsx(P,{children:e.jsxs(j,{className:"p-10",children:[e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Member ID"}),e.jsx(a.Control,{type:"text",name:"memberId",value:t.memberId,onChange:n,placeholder:"Enter Member ID",disabled:r})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Iqama Number"}),e.jsx(a.Control,{type:"text",name:"iqamaNumber",value:t.iqamaNumber,onChange:n,placeholder:"Enter Iqama Number",disabled:r})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Name"}),e.jsx(a.Control,{type:"text",name:"name",value:t.name,onChange:n,placeholder:"Enter Name",disabled:r})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Phone Number"}),e.jsx(a.Control,{type:"text",name:"phoneNumber",value:t.phoneNumber,onChange:n,placeholder:"Enter Phone Number",disabled:r})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Status"}),e.jsxs(a.Select,{name:"status",value:t.status,onChange:n,disabled:r,children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Constituency"}),e.jsx(a.Control,{type:"text",name:"areaName",value:t.areaName,onChange:n,placeholder:"Enter Area Name",disabled:r})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(f,{variant:"secondary",onClick:()=>c("/membership"),disabled:r,children:"Cancel"}),e.jsxs(f,{variant:"primary",className:"flex-grow-1",onClick:I,disabled:r,children:[e.jsx(L,{icon:o?"mdi:account-edit":"mdi:account-plus"})," ",r?o?"Updating...":"Adding...":o?"Update Membership":"Add Membership"]})]})]})})})})})]})};export{se as default};
