import{d as P,r as s,j as e,T as R,h as $,i as z,L as g}from"./index-D9C8xGDJ.js";import{P as F}from"./PageTitle-CTV_nOCB.js";import{a as f}from"./api-CQpZrRPq.js";import{I as j}from"./IconifyIcon-B_FaLXx1.js";import{l as K}from"./logo-sm-Bq_R7RX3.js";import{M as q}from"./MemberForm-e1fm4iuz.js";import{R as M,C as N}from"./Row-DNXGtDaS.js";import{C as p}from"./Card-Bg5eLJtX.js";import{B as G}from"./Badge-lUxFseza.js";import{B as o}from"./Button-jzwfO54I.js";import{T as J}from"./Tabs-hyqOYmuU.js";import{T}from"./Tab-CueF4Tov.js";import{T as v}from"./Table-Bjq8m4ox.js";import{M as i}from"./Modal-CL_CNIw1.js";import"./iconify-D7I9lgUj.js";import"./cropper-CrwDflkO.js";import"./Form-B7ZRRNa0.js";import"./FormCheck-CFPqw4o6.js";import"./FormContext-D-yD9u-c.js";import"./ElementChildren-DgCQtZUg.js";import"./FormControl-DWlS3GFR.js";import"./FormLabel-BEDtgQcg.js";import"./CardHeaderContext-B6CePyy5.js";import"./divWithClassName-2VyLv_7K.js";import"./Button-_Yz-NvGp.js";import"./hook-C3BOm-4g.js";import"./extends-CF3RwP-h.js";import"./TabPane-C9mZeohU.js";import"./Nav-CXlgxRYC.js";import"./DataKey-COGXBUcQ.js";import"./NavContext-B1rVRbJL.js";import"./useMergedRefs-ChISKg02.js";import"./NavItem-36seL4NA.js";import"./useEventCallback-CSjVCyuo.js";import"./NavbarContext-CB5P2alw.js";import"./NavLink-BkCHfwj5.js";import"./Anchor-BPHPD6tX.js";import"./NoopTransition-CoSkVbwQ.js";import"./AbstractModalHeader-B0m5d8Cx.js";import"./useWindow-B79ER2bB.js";import"./usePrevious-DlNrynkd.js";import"./hasClass-DiruUP4K.js";const ke=()=>{const{committeeId:a}=P(),[n,w]=s.useState(null),[c,u]=s.useState([]),[C,b]=s.useState(!0),[S,l]=s.useState(!1),[D,m]=s.useState(""),[B,h]=s.useState(!1),[A,x]=s.useState(!1),[r,y]=s.useState(null),[I,E]=s.useState("details");s.useEffect(()=>{(async()=>{try{b(!0);const[d,L]=await Promise.all([f.get(`/constitution-committees/${a}`),f.get(`/constitution-committees/${a}/members`)]);w(d.data.data),u(L.data.data)}catch(d){console.error("Error fetching committee details:",d),m("Failed to load committee details"),l(!0)}finally{b(!1)}})()},[a]);const k=t=>{u([...c,t]),h(!1),m("Member added successfully"),l(!0)},H=async()=>{if(r)try{await f.delete(`/constitution-committees/members/${r.id}`),u(c.filter(t=>t.id!==r.id)),m("Member deleted successfully"),l(!0)}catch(t){console.error("Error deleting member:",t),m("Failed to delete member"),l(!0)}finally{x(!1),y(null)}};return C?e.jsx("div",{className:"d-flex justify-content-center p-5",children:"Loading..."}):n?e.jsxs("div",{className:"d-flex p-4",children:[e.jsx(F,{title:"Committee Details"}),e.jsxs(R,{onClose:()=>l(!1),show:S,delay:5e3,autohide:!0,style:{position:"fixed",top:20,right:20,zIndex:9999},children:[e.jsxs($,{children:[e.jsx("img",{src:K,alt:"brand-logo",height:"16",className:"me-1"}),e.jsx("strong",{className:"me-auto",children:"KMCC"})]}),e.jsx(z,{children:D})]}),e.jsx(M,{className:"w-100",children:e.jsx(N,{xs:12,children:e.jsx(p,{children:e.jsxs(p.Body,{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsxs("h4",{children:[n.title,e.jsxs(G,{bg:"primary",className:"ms-2",children:[c.length," Members"]})]}),e.jsxs("div",{children:[e.jsxs(o,{variant:"primary",className:"me-2",as:g,to:`/constitution-committees/edit/${a}`,children:[e.jsx(j,{icon:"mdi:pencil",className:"me-1"}),"Edit"]}),e.jsxs(o,{variant:"success",onClick:()=>h(!0),children:[e.jsx(j,{icon:"mdi:plus",className:"me-1"}),"Add Member"]})]})]}),e.jsxs(J,{activeKey:I,onSelect:t=>E(t),className:"mb-3",children:[e.jsx(T,{eventKey:"details",title:"Details",children:e.jsx(M,{className:"mt-3",children:e.jsx(N,{md:12,children:e.jsx(p,{children:e.jsxs(p.Body,{children:[e.jsx("h5",{children:"Committee Information"}),e.jsx(v,{bordered:!0,children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:"Title"}),e.jsx("td",{children:n.title})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Description"}),e.jsx("td",{children:n.description||e.jsx("span",{className:"text-muted",children:"No description"})})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Created At"}),e.jsx("td",{children:new Date(n.createdAt).toLocaleString()})]})]})})]})})})})}),e.jsx(T,{eventKey:"members",title:"Members",children:e.jsx("div",{className:"mt-3",children:e.jsxs(v,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Position"}),e.jsx("th",{children:"Image"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:c.map((t,d)=>e.jsxs("tr",{children:[e.jsx("td",{children:d+1}),e.jsx("td",{children:t.name}),e.jsx("td",{children:t.position}),e.jsx("td",{children:t.image?e.jsx("img",{src:t.image,alt:t.name,style:{height:"50px"}}):e.jsx("span",{className:"text-muted",children:"No image"})}),e.jsxs("td",{children:[e.jsx(o,{variant:"primary",size:"sm",className:"me-2",as:g,to:`/constitution-committees/members/edit/${t.id}`,children:e.jsx(j,{icon:"mdi:pencil",color:"white"})}),e.jsx(o,{variant:"danger",size:"sm",onClick:()=>{y(t),x(!0)},children:e.jsx(j,{icon:"mdi:delete",color:"white"})})]})]},t.id))})]})})})]})]})})})}),e.jsxs(i,{show:B,onHide:()=>h(!1),size:"lg",children:[e.jsx(i.Header,{closeButton:!0,children:e.jsx(i.Title,{children:"Add New Member"})}),e.jsx(i.Body,{children:e.jsx(q,{committeeId:a,onSuccess:k,onCancel:()=>h(!1)})})]}),e.jsxs(i,{show:A,onHide:()=>x(!1),centered:!0,children:[e.jsx(i.Header,{closeButton:!0,children:e.jsx(i.Title,{children:"Delete Member"})}),e.jsxs(i.Body,{children:['Are you sure you want to delete "',r==null?void 0:r.name,'"? This action cannot be undone.']}),e.jsxs(i.Footer,{children:[e.jsx(o,{variant:"secondary",onClick:()=>x(!1),children:"Cancel"}),e.jsx(o,{variant:"danger",onClick:H,children:"Delete"})]})]})]}):e.jsx("div",{className:"d-flex justify-content-center p-5",children:"Committee not found"})};export{ke as default};
